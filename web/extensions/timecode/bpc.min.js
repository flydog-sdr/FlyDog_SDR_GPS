

/* web/extensions/timecode/bpc.min.js (web/extensions/timecode/bpc.js = Thu Mar  3 07:00:47 2022) */
var bpc={arm:0,NOISE_THRESHOLD:3,cur:0,sec:0,msec:0,dcnt:0,line:0,phase:0,prev:[],raw:[],chr:0,tod:0,time:0,dibit:["00","01","10","11"],end:null};function bpc_dmsg(t){w3_innerHTML("id-tc-bpc",t)}function bpc_legend(){0==(3&bpc.line)&&tc_dmsg("ss hhhhhh mmmmmm ?????? dddddd mmmm yyyyyy ?? <br>")}function bpc_decode(t){var c=(c=16*t[1]+4*t[2]+t[3])<=11?(2&t[9]&&(c+=12),c.leadingZeros(2)):"??",e=59<(e=16*t[4]+4*t[5]+t[6])?"??":e.leadingZeros(2),d=2<(d=t[0])?"??":(20*d).leadingZeros(2),n=0==(n=16*t[10]+4*t[11]+t[12])||31<n?"??":n.fieldWidth(2),i=4*t[13]+t[14],d=n+" "+(i=0==i||12<i?"???":tc.mo[i-1])+" "+(16*t[15]+4*t[16]+t[17]+2e3)+" "+c+":"+e+":"+d+" CST";tc_dmsg("   "+d+"<br>"),tc_stat("lime","Time decoded: "+d)}function bpc_clr(){var t=bpc;t.cur=t.cnt=t.one_width=t.zero_width=0,t.phase^=1,t.arm=t.no_modulation=t.dcnt=t.modct=t.line=t.sec=t.msec=0,tc.trig=0,tc.state=tc.ACQ_SYNC,null!=server_time_local&&""!=server_time_local&&(t.time=3600*parseInt(server_time_local)+60*parseInt(server_time_local.substr(3))+60),t.tod=t.time}function bpc_ampl(t){var c,e=bpc;tc.trig++,100<=tc.trig&&(tc.trig=0),t=.5<t?1:0,tc.ref||(tc.data=t^e.phase,tc.ref=1),t==e.cur?e.cnt=0:(e.cnt++,e.cnt>e.NOISE_THRESHOLD&&(e.cur=t,e.cnt=0,tc.data_last=tc.data,tc.data^=1,tc.data?(tc.state!=tc.ACQ_SYNC&&(4<=(c=Math.round((e.zero_width-9)/10))&&(c=0),e.raw[e.dcnt]=c,t=e.dibit[c],c!=e.prev[e.dcnt]&&e.line&&(t='<span style="color:lime">'+t+"</span>"),e.prev[e.dcnt]=c,tc_dmsg(t),[0,3,6,9,12,14,17].includes(e.dcnt)&&tc_dmsg(" "),e.dcnt++,19<=e.dcnt&&(bpc_decode(e.raw),e.dcnt=0,e.line++,bpc_legend())),e.one_width=0):e.zero_width=0)),tc.data?e.one_width++:e.zero_width++,tc.state==tc.ACQ_SYNC&&0==e.arm&&170<=e.one_width&&(e.arm=1,e.one_width=0),1==e.arm&&1==tc.data_last&&0==tc.data&&(e.arm=2,tc.state=tc.SYNCED,tc.trig=0,tc.sample_point=40,bpc_legend(),tc_stat("cyan","Found sync")),e.msec+=10,1e3==e.msec&&(e.sec++,e.msec=0)}function bpc_focus(){}function bpc_blur(){var t=w3_el("id-tc-bits");t&&(t.innerHTML=""),(t=w3_el("id-tc-bpc"))&&(t.innerHTML="")}function bpc_init(){w3_el("id-tc-addon").innerHTML+=w3_div("id-tc-bits")+w3_div("id-tc-bpc")}



