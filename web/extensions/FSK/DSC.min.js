

/* web/extensions/FSK/DSC.min.js (web/extensions/FSK/DSC.js = Tue Jun  7 12:16:43 2022) */
function DSC(a,e){var n=this;console.log("FSK encoder: DSC"),a&&e("\f"+ansi.RED+"WARNING: Do not use the DSC decoder in any life-safety application. Hobby radio monitoring only.\n"+ansi.NORM+"No distress messages are currently decoded. See the KiwiSDR forum for details.\n\n"),n.dbg=0,n.test_msgs=0,n.dump_eos=0,n.start_bit=0,n.seq=0,n.MSG_LEN_MIN=62,n.MSG_LEN_MAX=80,n.FIRST_CALL=!0,n.POS_REQUEST=!0,n.synced=0,n.sym_s=["   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","   ","GEO","   ","Pr0","Pr1","Pr2","Pr3","Pr4","Pr5","Pr6","Pr7","*D*","   ","INT","   ","ALL","ARQ","   ","   ","STA","RSV","ABQ","ATO","   ","Pdx","  *","EOS"],n.DX=125,n.RX7=111,n.FMT_GEO_AREA=102,n.FMT_DISTRESS=112,n.FMT_COMMON_INTEREST=114,n.FMT_ALL_SHIPS=116,n.FMT_INDIV_STA=120,n.FMT_RESV=121,n.FMT_IS_SEMI_AUTO=123,n.CAT_ROUTINE=100,n.CAT_SAFETY=108,n.CAT_URGENCY=110,n.CAT_DISTRESS=112,n.CMD1_FM_CALL=100,n.CMD1_FM_DUPLEX_CALL=101,n.CMD1_POLLING=103,n.CMD1_UNABLE_COMPLY=104,n.CMD1_END_OF_CALL=105,n.CMD1_F1B_DATA=106,n.CMD1_J3E_RT=109,n.CMD1_DISTRESS_ACK=110,n.CMD1_DISTRESS_ALERT_RELAY=112,n.CMD1_F1B_FEC=113,n.CMD1_F1B_ARQ=115,n.CMD1_TEST=118,n.CMD1_POSITION=121,n.CMD1_NOP=126,n.CMD2_UNABLE_FIRST=100,n.CMD2_BUSY=102,n.CMD2_UNABLE_LAST=109,n.CMD2_NON_CONFLICT=110,n.CMD2_MED_TRANSPORTS=111,n.CMD2_NOP=126,n.ARQ=117,n.ABQ=122,n.EOS=127,n.NOP=126,n.ecc_sym=["fmt","to1","to2","to3","to4","to5","cat","from1","from2","from3","from4","from5","cmd1","cmd2","freq1.1","freq1.2","freq1.3","freq2.1","freq2.2","freq2.3","eos"],n.pos_s=[" dx","rx7"," dx","rx6"," dx","rx5"," dx","rx4"," dx","rx3"," dx","rx2","Afmt","rx1","Afmt","rx0","Bto1","Afmt","Bto2","Afmt","Bto3","Bto1","Bto4","Bto2","Bto5","Bto3","Cat","Bto4","Dfr1","Bto5","Dfr2","Cat","Dfr3","Dfr1","Dfr4","Dfr2","Dfr5","Dfr3","E1cmd","Dfr4","E2cmd","Dfr5","Ffreq1","E1cmd","Ffreq2","E2cmd","Ffreq3","Ffreq1","Gfreq1","Ffreq2","Gfreq2","Ffreq3","Gfreq3","Gfreq1","eos","Gfreq2","ecc","Gfreq3","eos","eos","eos","ecc"],n.pos={},n.pos_n={},n.pos_s.forEach(function(a,e){a=a.trim(),isDefined(n.pos_n[a])||(n.pos_n[a]=0),n.pos[a+"-"+n.pos_n[a].toString()]=e,n.pos_n[a]++}),n.dbg&&console.log(n.pos);function r(a){return a=kiwi_bitCount(127^a),kiwi_bitReverse(a,3)}n.DX_w=r(n.DX)<<7|n.DX,n.svec=[];for(var o,s,i,t,l,u,c,S,C,_,d,M,A,m,h,T,E,g=n.RX7,f=0;f<12;f++)n.svec[f]=1&f?r(g)<<7|g:n.DX_w,1&f&&g--;n.format_s={102:"geo-area",112:"*distress*",114:"com-int",116:"all-ships",120:"indiv-sta",121:"resv",123:"semi-auto"},n.category_s={100:"routine",108:"safety",110:"urgency",112:"*distress*"},n.MID_area=["Europe","N.AM/C.AM","Asia","Oceania","Africa","S.AM"],n.tlist=null,n.test_msgs&&(o={s:"Afmt",n:n.FMT_COMMON_INTEREST},s={s:"Afmt",n:n.FMT_ALL_SHIPS},i={s:"Afmt",n:n.FMT_GEO_AREA},t={s:"Afmt",n:n.FMT_INDIV_STA},n.FMT_DISTRESS,n.CAT_DISTRESS,l={s:"Cat",n:n.CAT_URGENCY},u={s:"Cat",n:n.CAT_SAFETY},c={s:"Cat",n:n.CAT_ROUTINE},S={s:"E1cmd",n:n.CMD1_FM_CALL},C={s:"E1cmd",n:n.CMD1_J3E_RT},_={s:"E1cmd",n:n.CMD1_F1B_FEC},d={s:"E1cmd",n:n.CMD1_POSITION},M={s:"E1cmd",n:n.CMD1_TEST},A={s:"E2cmd",n:n.CMD2_MED_TRANSPORTS},m={s:"Ffreq1",n:2},h={s:"Ffreq2",n:34},T={s:"Ffreq3",n:56},E={s:"eos",n:n.EOS},a={s:"eos",n:n.ARQ},e={s:"eos",n:n.ABQ},n.tlist=[],n.tlist.push([t,u,M,{s:"Bto1",n:0},{s:"Bto2",n:36},{s:"Bto3",n:69},{s:"Bto4",n:99},{s:"Bto5",n:30},E]),n.tlist.push([t,u,S,{s:"Bto1",n:97},{s:"Bto2",n:41},{s:"Bto3",n:90},{s:"Bto4",n:12},{s:"Bto5",n:30},a]),n.tlist.push([t,c,S,{s:"Bto1",n:97},{s:"Bto2",n:51},{s:"Bto3",n:90},{s:"Bto4",n:12},{s:"Bto5",n:30},e]),n.tlist.push([t,u,d,{s:"Ffreq1",n:55},{s:"Ffreq2",n:21},{s:"Ffreq3",n:23},{s:"Gfreq1",n:41},{s:"Gfreq2",n:56},{s:"Gfreq3",n:78},a]),n.tlist.push([t,u,d,{s:"Ffreq1",n:21},{s:"Ffreq2",n:23},{s:"Ffreq3",n:41},{s:"Gfreq1",n:56},{s:"Gfreq2",n:78},{s:"Gfreq3",n:n.NOP},e]),n.tlist.push([t,c,C,{s:"Ffreq1",n:55},{s:"Ffreq2",n:21},{s:"Ffreq3",n:23},{s:"Gfreq1",n:41},{s:"Gfreq2",n:56},{s:"Gfreq3",n:78},e]),n.tlist.push([s,u,C,m,h,T,E]),n.tlist.push([i,l,C,A,{s:"Bto1",n:21},{s:"Bto2",n:21},{s:"Bto3",n:34},{s:"Bto4",n:2},{s:"Bto5",n:3},m,h,T,E]),n.tlist.push([t,u,C,m,h,T,{s:"Ffreq1",n:12},{s:"Ffreq2",n:78},{s:"Ffreq3",n:90},a]),n.tlist.push([o,c,_,{s:"Bto1",n:2},{s:"Bto2",n:19},{s:"Bto3",n:0},{s:"Bto4",n:0},{s:"Bto5",n:0},m,h,T,E]),n.tlist.push([t,c,{s:"E1cmd",n:n.CMD1_UNABLE_COMPLY},{s:"E2cmd",n:n.CMD2_UNABLE_FIRST},m,h,T,e])),n.init_MID_MMSI()}DSC.prototype.sym_by_sym_name=function(a){a=this.pos[a];return{pos:a,sym:this.syms[a]}},DSC.prototype.output_msg=function(a){return(new Date).toUTCString().substr(17,8)+" "+(ext_get_freq()/1e3).toFixed(2)+" "+a+"\n"},DSC.prototype.process_msg=function(a){var g=this,f=[];g.test=g.tlist&&g.tlist.length?g.tlist[0]:null;function p(n,a,e){if(g.test){var r=-1;if(g.test.forEach(function(a,e){n==a.s&&(r=e)}),-1!=r){var o=g.test[r].n;return console.log("TEST "+n+"="+o),{n:o,sym_s:o.toString(),z:o.leadingZeros(2),nop:o==g.NOP,err:0}}}var s=[];for(u=0;u<a;u++){o=g.sym_by_sym_name(n+"-"+u);g.bc_err[o.pos]||s.push(o)}var i=0==s.length,t=0;if(!i)for(var l=s[0],u=1;u<s.length;u++){var c=s[u];l.sym!=c.sym&&(t=1)}if(i||t){var S="";for(i&&(S+="(ALL Zerr) "),u=0;u<a;u++){var C=n+"-"+u,o=g.sym_by_sym_name(C);S+=C+":"+(g.bc_err[o.pos]?"Zerr":o.sym)+" "}g.FEC_errors++,g.dbg&&console.log("FEC FAIL: "+e+" "+S)}return i?{n:-1,err:1}:(o=s[0].sym,isUndefined(o)&&console.log(s),{n:t?-1:o,sym_s:o.toString(),z:o.leadingZeros(2),nop:o==g.NOP,err:t})}function y(a){return g.MID[a]||"(unknown)"}var e,n,r,o=function(a,e,n){var r=p(a+"1",2,n),o=p(a+"2",2,n),s=p(a+"3",2,n),i=p(a+"4",2,n),n=p(a+"5",2,n);if(f.push(r.n),f.push(o.n),f.push(s.n),f.push(i.n),f.push(n.n),r.err||o.err||s.err||i.err||n.err)return{s:"callFEC",err:1};var t,l=r.z,u=o.z,c=s.z,S=i.z,C=n.z,_=c+S+C[0],d=l+u+_,M=+l[0],i=+l[1],n=+u[0],A=2<=M&&M<=7,m=2<=i&&i<=7,h=2<=n&&n<=7,e=e.n;switch(e=(e=(e=e==g.FMT_GEO_AREA&&"Dfr"==a?g.FMT_INDIV_STA:e)==g.FMT_ALL_SHIPS&&"Dfr"==a?g.FMT_INDIV_STA:e)==g.FMT_COMMON_INTEREST&&"Dfr"==a?g.FMT_INDIV_STA:e){case g.FMT_INDIV_STA:E="",A?(T=l+u[0],E=w3_link("w3-esc-html w3-link-darker-color","www.marinetraffic.com/en/ais/details/ships/mmsi:"+d,d)+"[Flag: "+y(T)+"]"):"00"==l&&h?(T=u+c[0],t=u+_,E=d+"[Coast Station: "+y(T)+", "+(t=t,g.MMSI_coast[t]||"(unknown)")+"]"):0==M&&m?(T=l[1]+u,E=d+"[Ship group: "+y(T)+"]"):"99"==l&&h?(T=u+c[0],E=d+"[NAVAID: "+y(T)+"]"):"98"==l&&h?(T=u+c[0],E=d+"[Associated craft: "+y(T)+"]"):"97"==l?(0==(t=+u[0])?E="[SAR transponder]":2==t?E="[MOB device]":4==t&&(E="[EPIRB]"),""!=E&&(E=d+R(ansi.YELLOW,E))):1==M?E=d+R(ansi.YELLOW,"[SAR aircraft]"):8==M&&(E=d+"[Handheld VHF]"),""==E&&(E=d+R(ansi.YELLOW,"[Unknown]"));break;case g.FMT_DISTRESS:case g.FMT_ALL_SHIPS:E="[All ships]";break;case g.FMT_COMMON_INTEREST:E=0==M&&m?(T=l[1]+u,d+"[Ship group: "+y(T)+"]"):d+"[Ship group]";break;case g.FMT_GEO_AREA:var T=0==M||2==M?"":"-",E=(0==M||1==M?"":"-")+l[1]+u[0]+"°/"+T+u[1]+c+"° "+S+"°V/"+C+"°H [Area]";break;default:E=R(ansi.YELLOW,d)+"[Other]"}return{s:E,z:d+C[1],err:0}},s=function(a,e){e=p(a,2,e);return f.push(e.n),e.s=e.err?"cmdFEC":e.nop?"*":e.sym_s,e},i=function(a,e,n,r){var o=p(a+"1",2,n),s=p(a+"2",2,n),i=p(a+"3",2,n);if(f.push(o.n),f.push(s.n),f.push(i.n),o.err||s.err||i.err)return{s:"freqFEC",err:1};var t="",a=0;if(!o.nop&&!s.nop){n=o.z[0];if(e&&S.n==g.CMD1_POSITION&&(a=5),1==r||"5"==n||5==a)return{s:o.z+s.z+i.z,type:5,err:0};if("0"==n||"1"==n||"2"==n)return{s:("0"==n?o.z[1]:o.z)+s.z+i.z[0]+"."+i.z[1],type:6,err:0};"4"==n&&(t="7-DIGIT MODE|",a=7)}return o.nop&&(o.z="*"),s.nop&&(s.z="*"),i.nop&&(i.z="*"),{s:t+o.z+"|"+s.z+"|"+i.z,type:a,err:0}},R=function(a,e){return a+e+ansi.NORM},t=(e=p("Afmt",4,"format"),f.push(e.n),e.s=e.err?"fmtFEC":g.format_s[e.sym_s],e.s=e.s||e.n+"?",e),l=o("Bto",t,"called to"),u=(n=p("Cat",2,"category"),f.push(n.n),n.s=n.err?"catFEC":g.category_s[n.sym_s],n.s=n.s||n.n+"?",n),c=o("Dfr",t,"called from"),S=s("E1cmd","telecommand 1"),C=s("E2cmd","telecommand 2"),_=i("Ffreq",g.FIRST_CALL,"frequency 1"),d=i("Gfreq",!1,"frequency 2",5==_.type),M=(r=p("eos",4,"EOS"),f.push(r.n),r.s=r.err?"eosFEC":r.n==g.EOS?"EOS":r.n==g.ARQ?"ARQ":r.n==g.ABQ?"ABQ":"eos?",r),A=function(){var a=p("ecc",2,"ECC");a.fail=!1;function e(){err=[],f.forEach(function(a,e){err.push({n:g.ecc_sym[e],s:a})}),console.log(err)}var n;return a.err||g.test||(n=0,f.forEach(function(a,e){n^=a}),console.log("ECC len="+f.length+" got="+n+" want="+a.n),a.fail=n!=a.n,dbgUs&&a.fail&&e()),dbgUs&&g.test&&e(),a.s=a.err?"eccFEC":a.fail?"eccFAIL":"",a}(),m=g.parity_errors?" "+R(ansi.BLUE,g.parity_errors+" PE"):"",o=A.err?"ECC FEC":A.fail?"ECC":"";""!=o&&(o=" "+R(ansi.RED,o));function h(a,e){return a+(M.n==g.ABQ?" ack":"")+(e||"")}function T(a){return a+", "+c.s+" => "+l.s}function E(a){var e,n,r="";return 6==_.type?(r+=" "+_.s,6==d.type&&(r+="/"+d.s),r+=" kHz"):5==_.type&&(e=1==a&&M.n==g.ABQ?0:2,r=" "+(0==(a=+(n=_.s+d.s)[0+e])||1==a?"":"-")+n[1+e]+n[2+e]+"°"+n[3+e]+n[4+e]+"'/"+(0==a||2==a?"":"-")+n[5+e]+n[6+e]+n[7+e]+"°"+n[8+e]+n[9+e]+"'"),r}var D,s=t.err||l.err||u.err||c.err||S.err||C.err||_.err||d.err||M.err;if(!s)if(t.n==g.FMT_DISTRESS&&M.n==g.EOS)F=D="4.1";else if(u.n==g.CAT_DISTRESS&&t.n==g.FMT_ALL_SHIPS&&S.n==g.CMD1_DISTRESS_ACK&&M.n==g.EOS)F=D="4.2";else if(u.n!=g.CAT_DISTRESS||S.n!=g.CMD1_DISTRESS_ALERT_RELAY||M.n!=g.EOS&&M.n!=g.ARQ)if(u.n==g.CAT_DISTRESS&&S.n==g.CMD1_DISTRESS_ALERT_RELAY&&M.n==g.ABQ)F=D="4.4";else if(u.n!=g.CAT_SAFETY&&u.n!=g.CAT_URGENCY||t.n!=g.FMT_ALL_SHIPS||C.n!=g.CMD2_NOP||M.n!=g.EOS)if(u.n!=g.CAT_SAFETY&&u.n!=g.CAT_URGENCY||t.n!=g.FMT_GEO_AREA||M.n!=g.EOS)if(u.n!=g.CAT_SAFETY&&u.n!=g.CAT_URGENCY||t.n!=g.FMT_INDIV_STA)if(u.n==g.CAT_ROUTINE&&t.n==g.FMT_COMMON_INTEREST&&C.n==g.CMD2_NOP&&M.n==g.EOS)switch(F=D="4.8",S.n){case g.CMD1_J3E_RT:F=T("SSB call"+E());break;case g.CMD1_F1B_FEC:F=T("FSK-FEC call"+E())}else if(u.n!=g.CAT_ROUTINE||t.n!=g.FMT_INDIV_STA||M.n!=g.ARQ&&M.n!=g.ABQ)F=D=u.n!=g.CAT_ROUTINE||t.n!=g.FMT_IS_SEMI_AUTO||M.n!=g.ARQ&&M.n!=g.ABQ?"4.x":"4.10";else if(F=D="4.9",C.n==g.CMD2_NOP)switch(S.n){case g.CMD1_FM_CALL:F=T(h("FM call",E()));break;case g.CMD1_FM_DUPLEX_CALL:F=T(h("FM duplex call",E()));break;case g.CMD1_J3E_RT:F=T(h("SSB call",E()));break;case g.CMD1_F1B_FEC:F=T(h("FSK-FEC call",E()));break;case g.CMD1_F1B_ARQ:F=T(h("FSK-ARQ call",E()));break;case g.CMD1_F1B_DATA:F=T(h("FSK-DATA call",E()));break;case g.CMD1_POLLING:F=T(h("Polling"))}else S.n==g.CMD1_UNABLE_COMPLY&&C.n>=g.CMD2_UNABLE_FIRST&&C.n<=g.CMD2_UNABLE_LAST&&M.n==g.ABQ&&(F=T(R(ansi.YELLOW,"Unable to comply ack")+E()));else if(F=D="4.7",M.n==g.ARQ||M.n==g.ABQ)if(C.n==g.CMD2_NOP)switch(S.n){case g.CMD1_FM_CALL:F=T(h("FM call",E()));break;case g.CMD1_FM_DUPLEX_CALL:F=T(h("FM duplex call",E()));break;case g.CMD1_J3E_RT:F=T(h("SSB call",E()));break;case g.CMD1_F1B_FEC:F=T(h("FSK-FEC call",E()));break;case g.CMD1_F1B_ARQ:F=T(h("FSK-ARQ call",E()));break;case g.CMD1_POSITION:F=T(h("Position request",E(g.POS_REQUEST)));break;case g.CMD1_TEST:F=T(h("Test"))}else S.n==g.CMD1_UNABLE_COMPLY&&C.n>=g.CMD2_UNABLE_FIRST&&C.n<=g.CMD2_UNABLE_LAST&&M.n==g.ABQ&&(F=T(R(ansi.YELLOW,"Unable to comply ack")+E()));else M.n==g.EOS&&S.n==g.CMD1_TEST&&C.n==g.CMD2_NOP&&(F=T("Test"));else{var F=D="4.6",B=C.n==g.CMD2_NOP?"":C.n==g.CMD2_MED_TRANSPORTS?" medical":C.n==g.CMD2_NON_CONFLICT?" ships/aircraft":"";switch(S.n){case g.CMD1_J3E_RT:F=T("SSB call"+B+E());break;case g.CMD1_F1B_FEC:F=T("FSK-FEC call"+B+E())}}else switch(F=D="4.5",S.n){case g.CMD1_J3E_RT:F=T("SSB call"+E());break;case g.CMD1_F1B_FEC:F=T("FSK-FEC call"+E())}else F=D="4.3";dbgUs&&(b="$$ "+(s?"FEC FAIL":"OK"),i=kiwi_remove_escape_sequences(l.s),P=kiwi_remove_escape_sequences(c.s),console.log(b+" fmt="+t.s+" to="+i+" cat="+u.s+" from="+P),console.log(b+" cmd1="+S.s+" cmd2="+C.s+" freq1="+_.s+" freq2="+d.s+" eos="+M.s+" ecc="+A.s+m+o));var P="",b="";return s?(b=R(ansi.BLUE,g.FEC_errors+" FEC"),o=""):(P=F.startsWith("4.")?R(ansi.MAGENTA,"DECODE "+F)+" fmt="+t.n+" cat="+u.n+" cmd1="+S.n+" cmd2="+C.n+" from="+c.z+" to="+l.z+" freq1="+_.s+" freq2="+d.s+" eos="+M.n+" ecc="+A.n:(dbgUs?D+" ":"")+function(){if(t.n==g.FMT_DISTRESS)return R(ansi.RED,"DISTRESS");switch(u.n){case g.CAT_DISTRESS:return R(ansi.RED,"DISTRESS");case g.CAT_URGENCY:return R(ansi.YELLOW,"URGENT");case g.CAT_SAFETY:return R(ansi.CYAN,"SAFETY");case g.CAT_ROUTINE:return R(ansi.GREEN,"ROUTINE")}return R(ansi.GREY,"UNKNOWN")}()+" "+F,g.test&&(P="TEST "+P,g.tlist.shift())),a?(F=""!=b?b:P,g.output_msg(F+m+o)):F=""!=b?"":g.output_msg(P+o)},DSC.prototype.code_to_char=function(a){return a<0||127<a?"???":this.sym_s[a]},DSC.prototype.reset=function(){var a=this;a.syncA=a.syncB=a.syncC=a.syncD=a.syncE=0},DSC.prototype.get_nbits=function(){return 10},DSC.prototype.get_msb=function(){return 512},DSC.prototype.check_bits=function(){return!1},DSC.prototype.search_sync=function(a){var e=this,n=a,a=1&e.syncA;e.syncA=e.syncA>>1&1023,e.syncA|=n?512:0,n=a,a=1&e.syncB,e.syncB=e.syncB>>1&1023,e.syncB|=n?512:0,n=a,a=1&e.syncC,e.syncC=e.syncC>>1&1023,e.syncC|=n?512:0,n=a,a=1&e.syncD,e.syncD=e.syncD>>1&1023,e.syncD|=n?512:0,n=a,a=1&e.syncE,e.syncE=e.syncE>>1&1023,e.syncE|=n?512:0;for(var r=0;r<=9;r++)if(e.syncC==e.svec[r]&&e.syncB==e.svec[r+1]&&e.syncA==e.svec[r+2])return console.log("SYNC-DRD-"+r),e.seq=r+3,e.full_syms=[],e.syms=[],e.bc_err=[],e.parity_errors=0,e.FEC_errors=0,e.synced=1,!0;for(r=1;r<=7;r+=2)if(e.syncE==e.svec[r]&&e.syncC==e.svec[r+2]&&e.syncA==e.svec[r+4])return console.log("SYNC-RRR-"+r),e.seq=r+5,e.full_syms=[],e.syms=[],e.bc_err=[],e.parity_errors=0,e.FEC_errors=0,e.synced=1,!0;return e.synced=0,!1},DSC.prototype.process_char=function(a,e,n,r,o){var s=this;if(!s.synced)return{resync:0};var i=(s.full_syms[s.seq]=a)>>7&7,t=127&a;s.syms[s.seq]=t,d=(d=s.pos_s[s.seq])||"unk";var l=s.code_to_char(t),u=(M=kiwi_bitReverse(i,3))!=(A=kiwi_bitCount(127^t))?" Zck="+M+" Zdata="+A:"";s.bc_err[s.seq]=M!=A,s.bc_err[s.seq]&&s.parity_errors++,s.dbg&&console.log(s.seq.leadingZeros(2)+" "+d.fieldWidth(6)+": "+l+" "+t.fieldWidth(3)+". "+i.toString(2).leadingZeros(3)+" "+t.toString(2).leadingZeros(7)+u),s.seq++;var c=!1;if(s.seq>=s.MSG_LEN_MIN){function S(a,e){return a+e+ansi.NORM}var C=function(a){var e=0;return s.bc_err[s.seq-2]||s.syms[s.seq-2]!=a||e++,s.bc_err[s.seq-3]||s.syms[s.seq-3]!=a||e++,s.bc_err[s.seq-4]||s.syms[s.seq-4]!=a||e++,s.bc_err[s.seq-8]||s.syms[s.seq-8]!=a||e++,3<=e&&console.log("eos_n("+a+")="+e),3<=e};if((c=C(s.EOS)||C(s.ARQ)||C(s.ABQ)?!0:c)||s.seq>s.MSG_LEN_MAX){C=0;if(c?(s.seq!=s.MSG_LEN_MIN&&(o&&n(s.output_msg(S(ansi.BLUE,"non-std len="+s.seq))),console.log("$$ non-std len="+s.seq),C=1),n(s.process_msg(o))):(c=s.parity_errors?" "+S(ansi.BLUE,s.parity_errors+" PE"):"",o&&n(s.output_msg(S(ansi.BLUE,"no EOS")+c)),console.log("$$ no EOS pe="+s.parity_errors),C=s.dump_eos),C&&dbgUs)for(var _=0;_<s.seq;_++){var d,a=s.full_syms[_],t=127&(a=isUndefined(a)?119:a);d=(d=s.pos_s[_])||"unk";var M,A,l=s.code_to_char(t),i=a>>7&7,u=(M=kiwi_bitReverse(i,3))!=(A=kiwi_bitCount(127^t))?" Zck="+M+" Zdata="+A:"";console.log(_.leadingZeros(2)+" "+d.fieldWidth(6)+": "+l+" "+t.fieldWidth(3)+". "+i.toString(2).leadingZeros(3)+" "+t.toString(2).leadingZeros(7)+u)}return s.synced=0,{resync:1}}}return{resync:0}},DSC.prototype.init_MID_MMSI=function(){this.MID={201:"Albania",202:"Andorra",203:"Austria",204:"Azores",205:"Belgium",206:"Belarus",207:"Bulgaria",208:"Vatican City",209:"Cyprus",210:"Cyprus",211:"Germany",212:"Cyprus",213:"Georgia",214:"Moldova",215:"Malta",216:"Armenia",218:"Germany",219:"Denmark",220:"Denmark",224:"Spain",225:"Spain",226:"France",227:"France",228:"France",229:"Malta",230:"Finland",231:"Faroe Is",232:"United Kingdom",233:"United Kingdom",234:"United Kingdom",235:"United Kingdom",236:"Gibraltar",237:"Greece",238:"Croatia",239:"Greece",240:"Greece",241:"Greece",242:"Morocco",243:"Hungary",244:"Netherlands",245:"Netherlands",246:"Netherlands",247:"Italy",248:"Malta",249:"Malta",250:"Ireland",251:"Iceland",252:"Liechtenstein",253:"Luxembourg",254:"Monaco",255:"Madeira",256:"Malta",257:"Norway",258:"Norway",259:"Norway",261:"Poland",262:"Montenegro",263:"Portugal",264:"Romania",265:"Sweden",266:"Sweden",267:"Slovak Republic",268:"San Marino",269:"Switzerland",270:"Czech Republic",271:"Turkey",272:"Ukraine",273:"Russian Federation",274:"Macedonia",275:"Latvia",276:"Estonia",277:"Lithuania",278:"Slovenia",279:"Serbia",301:"Anguilla",303:"Alaska (State of, USA)",304:"Antigua and Barbuda",305:"Antigua and Barbuda",306:"Sint Maarten/Bonaire/Cura§ao",307:"Aruba",308:"Bahamas",309:"Bahamas",310:"Bermuda",311:"Bahamas",312:"Belize",314:"Barbados",316:"Canada",319:"Cayman Is",321:"Costa Rica",323:"Cuba",325:"Dominica",327:"Dominican Republic",329:"Guadeloupe",330:"Grenada",331:"Greenland",332:"Guatemala",334:"Honduras",336:"Haiti",338:"USA",339:"Jamaica",341:"Saint Kitts/Nevis",343:"Saint Lucia",345:"Mexico",347:"Martinique",348:"Montserrat",350:"Nicaragua",351:"Panama",352:"Panama",353:"Panama",354:"Panama",355:"-",356:"-",357:"-",358:"Puerto Rico",359:"El Salvador",361:"Saint Pierre and Miquelon",362:"Trinidad and Tobago",364:"Turks and Caicos Is",366:"USA",367:"USA",368:"USA",369:"USA",370:"Panama",371:"Panama",372:"Panama",373:"Panama",374:"-",375:"Saint Vincent/Grenadines",376:"Saint Vincent/Grenadines",377:"Saint Vincent/Grenadines",378:"British Virgin Is",379:"US Virgin Is",401:"Afghanistan",403:"Saudi Arabia",405:"Bangladesh",408:"Bahrain",410:"Bhutan",412:"China",413:"China",414:"China",416:"Taiwan",417:"Sri Lanka",419:"India",422:"Iran",423:"Azerbaijan",425:"Iraq",428:"Israel",431:"Japan",432:"Japan",434:"Turkmenistan",436:"Kazakhstan",437:"Uzbekistan",438:"Jordan",440:"South Korea",441:"South Korea",443:"State of Palestine",445:"DPRK",447:"Kuwait",450:"Lebanon",451:"Kyrgyz Republic",453:"Macao",455:"Maldives",457:"Mongolia",459:"Nepal",461:"Oman",463:"Pakistan",466:"Qatar",468:"Syrian Arab Republic",470:"United Arab Emirates",472:"Tajikistan",473:"Yemen",475:"Yemen",477:"Hong Kong",478:"Bosnia and Herzegovina",501:"Adelie Land",503:"Australia",506:"Myanmar",508:"Brunei Darussalam",510:"Micronesia",511:"Palau",512:"New Zealand",514:"Cambodia",515:"Cambodia",516:"Christmas Is (Indian Ocean)",518:"Cook Is",520:"Fiji",523:"Cocos (Keeling) Is",525:"Indonesia",529:"Kiribati",531:"Lao People's D.Rep",533:"Malaysia",536:"Northern Mariana Is",538:"Marshall Is",540:"New Caledonia",542:"Niue",544:"Nauru",546:"French Polynesia",548:"Philippines",553:"Papua New Guinea",555:"Pitcairn Is",557:"Solomon Is",559:"American Samoa",561:"Samoa",563:"Singapore",564:"Singapore",565:"Singapore",566:"Singapore",567:"Thailand",570:"Tonga",572:"Tuvalu",574:"Viet Nam",576:"Vanuatu",577:"Vanuatu",578:"Wallis and Futuna Is",601:"South Africa",603:"Angola",605:"Algeria",607:"Saint Paul and Amsterdam Is",608:"Ascension Is",609:"Burundi",610:"Benin",611:"Botswana",612:"Central African Republic",613:"Cameroon",615:"Congo",616:"Comoros",617:"Cabo Verde",618:"Crozet Archipelago",619:"Cote d'Ivoire",620:"Comoros",621:"Djibouti",622:"Egypt",624:"Ethiopia",625:"Eritrea",626:"Gabonese Republic",627:"Ghana",629:"Gambia",630:"Guinea-Bissau",631:"Equatorial Guinea",632:"Guinea",633:"Burkina Faso",634:"Kenya",635:"Kerguelen Is",636:"Liberia",637:"Liberia",638:"South Sudan",642:"Libya",644:"Lesotho",645:"Mauritius",647:"Madagascar",649:"Mali",650:"Mozambique",654:"Mauritania",655:"Malawi",656:"Niger",657:"Nigeria",659:"Namibia",660:"Reunion",661:"Rwanda",662:"Sudan",663:"Senegal",664:"Seychelles",665:"Saint Helena",666:"Somalia",667:"Sierra Leone",668:"Sao Tome and Principe",669:"Swaziland",670:"Chad",671:"Togolese Republic",672:"Tunisia",674:"Tanzania",675:"Uganda",676:"D.Rep Congo",677:"Tanzania",678:"Zambia",679:"Zimbabwe",701:"Argentine",710:"Brazil",720:"Bolivia",725:"Chile",730:"Colombia",735:"Ecuador",740:"Falkland Is",745:"Guiana",750:"Guyana",755:"Paraguay",760:"Peru",765:"Suriname",770:"Uruguay",775:"Venezuela"},this.MMSI_coast={2040100:"Delgada",2040200:"Horta",2050480:"Oostende",2050485:"Antwerpen",2070810:"Varna",2091e3:"Cyprus",2111240:"Bremen Rescue Radio",2130100:"Batumi",2130300:"Poti",2191e3:"Lyngby",2240991:"Barcelona",2240992:"Coruna",2240993:"Finisterre",2240994:"Tarifa",2240995:"Las Palmas",2240996:"Bilbao",2240997:"Gijon",2240998:"Vigo",2241001:"Algeciras",2241002:"Almeria",2241003:"Cartegena",2241004:"Valencia",2241005:"Palma",2241006:"Tarragona",2241007:"Tenerife",2241008:"Madrid",2241009:"Santander",2241011:"Cadiz",2241012:"Huelva",2241016:"Castellon",2241021:"Bilbao",2241022:"Coruna",2241023:"Malaga",2241024:"Valencia",2241025:"Tenerife",2241026:"Las Palmas",2241078:"Madrid Radio",2275e3:"Etel",2275100:"Gris Nez",2275200:"Jobourg",2275300:"Corsen",2275400:"La Garde",2275420:"Aspretto",2300230:"Turku",2301e3:"Turku",2302e3:"Helsinki",2303e3:"Vaasa",2311e3:"Torshavn",2320001:"MRSC Shetland",2320004:"MRCC Aberdeen",2320005:"MRSC Forth",2320007:"MRSC Humber",2320008:"MRCC Yarmouth",2320009:"MRSC Thames",2320010:"MRCC Dover",2320011:"MRSC Solent",2320012:"MRSC Portland",2320013:"MRSC Brixham",2320014:"MRCC Falmouth",2320016:"MRCC Swansea",2320017:"MRSC Milford Haven",2320018:"MRSC Holyhead",2320019:"MRSC Liverpool",2320021:"MRSC Belfast",2320022:"MRCC Clyde",2320024:"MRSC Stornoway",2320060:"Jersey Radio",2320064:"S.Peter Port Radio",2371e3:"Olympia",237673e3:"Piraeus JRCC",237673140:"Patrai Port Auth",237673150:"Rodos Port Auth",237673180:"Iraklion Port Auth",237673190:"Kerkyra Port Auth",237673210:"Thessaloniki Port Auth",237673220:"Mytilini Port Auth",237673230:"Pylos Port Auth",2380100:"Split",2380200:"Rijeka",2380300:"Dubrovnik",2387010:"Rijeka",2387020:"Rijeka",2387030:"Split",2387040:"Split",2387400:"Zadar",2387401:"Zadar",2387500:"Sibenik",2387501:"Sibenik",2387800:"Dubrovnik",2387801:"Dubrovnik",2391e3:"Aspropirgos Attikis",2442e3:"Netherland CG Radio",2470001:"Roma",2470002:"Palermo",2500100:"Malin Head",2500200:"Valentia",2500300:"Dublin",2510100:"Reykjavik",2510200:"Reykjavik",2550100:"Funchal",2550200:"Porto Santo",257e4:"All Norwegian Stations",2570100:"Tjoeme",2570300:"Rogaland",2570500:"Floroe",2570700:"Bodoe",2570800:"Vardoe",2570900:"Svalbard/Bjoernoeya/Jan Mayen",2610210:"Witowo",2630100:"Lisboa",2630200:"Apulia",2630400:"Sagres",2640570:"Constanta",2653e3:"Goteborg",2711e3:"Istanbul",2712e3:"Samsun",2713e3:"Antalya",2715e3:"Izmir",2723650:"Mariupol",2723655:"Yuzhnyy",2723659:"Kerch",2723660:"Odessa",2723663:"Theodosia",2723672:"Berdiansk",2733728:"Magadan",2733700:"Sankt Peterburg",2733733:"Yuzhno-Sakhalinsk",2734411:"Novorossiysk",2734412:"Vladivostok",2734413:"Tuapse",2734414:"Arkhangelsk",2734415:"Vyborg",2734416:"Magadan",2734417:"Kaliningrad",2734418:"Petropavlovsk-Kamchatskiy",2734419:"Astrakhan",2734420:"Murmansk",2734421:"Vanino",2734422:"Eisk/Rostov-na-Donu",2734423:"Makhachkala",2750100:"Riga Rescue Radio",2761e3:"Tallinn",2760120:"Kuressaare",2770330:"Klaipeda Rescue Centre",2780200:"Koper",2790001:"Bar",2790002:"Obosnik",3061e3:"Curacao",3100001:"Bermuda Harbour",3160010:"Vancouver",3160011:"Victoria",3160012:"Tofino",3160013:"Prince Rupert",3160014:"Comox",3160015:"St John",3160016:"Halifax",3160017:"Sydney",3160018:"Port Aux Basques",3160019:"Placentia",3160020:"St Johns",3160021:"St Anthony",3160022:"Labrador",3160023:"Iqaluit",3160025:"Riviere au Renard",3311e3:"Qaqortoq",3313e3:"Aasiaat",3314e3:"Ammassalik",3450010:"Cerrillo",34500475:"Isla Socorro",3450110:"Tampico",3450120:"La Pesca",3450172:"Matamoros",3450173:"Mezquital",3450174:"San Blas",3450210:"Ensenada",3450272:"Isla de Cedros",3450273:"Isla Guadalupe",3450274:"San Felipe",3450310:"Veracruz",3450320:"Coatzacoalcos",3450330:"Tuxpan",3450372:"Tuxpan",3450410:"La Paz",3450420:"Los Cabos",3450430:"San Carlos",3450440:"Guerrero Negro",3450471:"La Paz",3450472:"Isla Clarion/Puerto Cortez",3450473:"Los Cabos",3450474:"Santa Rosalia",3450610:"Guaymas",3450620:"Puerto Penasco",3450671:"Guaymas",3450672:"Puerto Penasco",3450710:"Ciudad de Carmen",3450720:"Campeche",3450772:"Lerma",3450810:"Mazatlan",3450820:"Topolobampo",3450872:"Topolobampo",3450910:"Progreso",3450974:"Cayo Arcas",3451110:"Cozumel",3451120:"Chetumal",3451130:"Puerto Juarez",3451171:"Isla Mujeres",3451174:"Isla Holbox",3451175:"Isla Contoy",3451176:"Playa Linda",3451210:"Puerto Vallarta",3451410:"Manzanillo",3451610:"Lazaro Cardenas",3451810:"Acapulco",3452010:"Salina Cruz",3452030:"Puerto Angel",3452071:"Salina Cruz",3452072:"Huatulco",3452210:"Puerto Madero",3452271:"Puerto Madero",3452272:"Paredon",3660030:"Mobile Radio/WLO",3669899:"USCG Kodiak",3669902:"Woods Hole",3669903:"Atlantic City",3669904:"Port Angeles",3669905:"Honolulu",3669906:"Cape Hatteras",3669907:"Charleston",3669908:"New Orleans",3669909:"Humboldt Bay",3669910:"Astoria WA",3669911:"North Bend",3669912:"Long Beach CA",3669913:"San Diego CA",3669914:"Mobile AL",3669915:"Galveston TX",3669916:"Corpus Christi",3669917:"St.Petersburg",3669918:"Key West FL",3669919:"Miami FL",3669920:"Fort Macon",3669921:"Southwest",3669922:"Juneau",3669924:"Valdez",3669925:"Mayport",3669926:"San Francisco",3669928:"South Portland",3669929:"New York NY",3669931:"New Haven",3669932:"Chincoteague",3669936:"Moriches",3669990:"USCG Pt Reyes CAMSPAC",3669991:"USCG Boston MA",3669992:"San Juan",3669993:"USCG Honolulu",3669994:"USCG Guam",3669995:"USCG Portsmouth CAMSLANT",3669997:"USCG Miami FL",3669998:"USCG New Orleans LA",3669999:"Any USCG",403e4:"Jeddah",4121100:"Tianjin",4121200:"Qinhuangdao",4121300:"Dalian",4121400:"Yantai",4122100:"Shanghai",4122200:"Qingdao",4122300:"Lianyungang",4122400:"Ningbo",4122500:"Wenzhou",4122600:"Fuzhou",4122700:"Xiamen",4123100:"Guangzhou",4123200:"Shantou",4123300:"Zhangjiang",4123400:"Beihai",4123500:"Haikou",4123600:"Basuo",4123700:"Sanya",4162019:"Chilung",4192201:"Daman",4192202:"Porbandar",4192203:"Mumbai",4192204:"New Mangalore",4192205:"Kochi",4192206:"Goa",4192207:"Okha",4194401:"Chennai",4194402:"Visakhapatnam",4194403:"Paradip",4194404:"Haldia",4194405:"Tuticorin",4194406:"Mandapam",4194407:"Diglipur",4194408:"Campbell Bay",4194409:"Port Blair",4225300:"Bandar Khomeyni",4225301:"Chabahar",4225302:"Bushehr",4225303:"Now-shahr",4225304:"Bander-e Abbas",4225305:"Anzali",4225306:"Kharg",4225307:"Lengeh",4225308:"Bahonar",4225309:"Khorramshahr",4225311:"Neka",4280001:"Haifa",4310001:"Tokyo Sea Patrol Radio",4310101:"Otaru",4310102:"Kushiro",4310201:"Shiogama",4310301:"Yokohama",4310401:"Nagoya",4310501:"Kobe",4310502:"Tanabe",4310503:"Kochi",4310601:"Hiroshima",4310701:"Moji",4310702:"Sasebo",4310801:"Maizuru",4310901:"Niigata",4311001:"Kagoshima",4311101:"Naha",4311102:"Ishigaki",4381234:"Aqaba Radio",4400001:"Inchon Radio",4400002:"Seoul Radio",4400101:"Pusan Radio",4400301:"Mokpo Radio",4400601:"Kangung Radio",4401001:"Inchon Police Radio",4401002:"Tonghae Police Radio",4401003:"Mokpo Police Radio",4401004:"Pusan Police Radio",4401005:"Cheju Police Radio",4472188:"Kuwait",4634052:"Gawadar",4634056:"Ormara",4634060:"Karachi",4661001:"Mesaieed Port",47e5:"Emirates",4773500:"Hong Kong Marine Rescue",5030001:"Charleville/Wiluna",5060100:"Yangon",5060200:"Myeik",5120010:"Taupo",5201100:"Suva",525e4:"Jakarta",5250001:"Surabaya",5250002:"Makassar",5250003:"Belawan",5250004:"Dumai",5250005:"Bitung",5250006:"Amboina",5250007:"Jayapura",5250008:"Semarang",5250009:"Balikpapan",5250010:"Kupang",5250011:"Sorong",5250012:"Batu Ampar",5250013:"Panjang",5250014:"Benoa",5250015:"Dili",5250016:"Pontianak",5250017:"Tarakan",5250018:"Pantoloan",5250019:"Kendari",5250020:"Ternate",5250021:"Merauke",5250022:"Lembar",5250023:"Manokwari",5250024:"Tahuna",5250025:"Sanana",5250026:"Fak-Fak",5250028:"Sibolga",5250029:"Sei Kolak Kiang/Tanjung Pinang",5250030:"Cilacap",5250031:"Biak",5330001:"Gunung Jerai",5330002:"Permatang Pauh",5330003:"Gunung Berinchang",5330004:"Ulu Kali",5330005:"Gunung Ledang",5330006:"Tioman",5330007:"Kuala Rompin",5330008:"Kuantan",5330009:"Kuala Terengganu",5330010:"Machang",5330011:"Kuching",5330012:"Bintulu",5330013:"Kota Kinabalu",5330014:"Labuan",5401e3:"Noumea",5480001:"Aparri",5480002:"San Jose",5480003:"San Fernando",5480004:"Cagayan de Oro",5480005:"Real",5480006:"Roxas",5480007:"Tacloban",5630002:"Singapore",5671e3:"Bangkok",5741993:"Ho Chi Minh-Ville",5741996:"Hai Phong",5741999:"Da Nang",5742001:"Nha Trang",5742004:"Vung Tau",5742006:"Hon Gai/Ha Long",5742007:"Mong Cai",5742008:"Cua Ong",5742009:"Ben Thuy",5742010:"Hue",5742011:"Quy Nhon",5742012:"Kien Giang",5742013:"Can Tho",5742014:"Thanh Hoa",5742015:"Bach Long",5742016:"Hon La",5742017:"Cua Viet",5742018:"Ly Son",5742019:"Quang Ngai",5742020:"Cam Ranh",5742021:"Phan Thiet",5742022:"Phu Quy",5742023:"Con Dao",5742024:"Tho Chu",5742025:"Nam Can",5742026:"Bac Lieu",5742027:"Ha Tien",5742028:"Phu Quoc",5742029:"Dung Quat",6010001:"Capetown",6100001:"Cotonou",6221111:"Alexandria",6221112:"Quseir",6221113:"Port Said",627e4:"Tema",6452700:"Mauritius",6501e3:"Maputo",6502e3:"Inhambane",6503e3:"Beira",6504e3:"Quelimane",6505e3:"Angoche",6506e3:"Nacala",6507e3:"Pema",7010001:"Buenos Aires",7010002:"Recalada Rio de la Plata",7010003:"Mar del Plata",7010005:"Bahia Blanca",7010006:"San Blas",7010007:"Rawson",7010008:"Comodoro Rivadavia",7010009:"Puerto Deseado",7010010:"Rio Gallegos",7010011:"Ushuaia",7010111:"Argentina Radio",7010221:"Mar del Plata",7100001:"Rio",7100002:"Recife",7100003:"Manaus",7250010:"Arica",7250020:"Iquique",7250030:"Tocopilla",7250040:"Mejillones",7250050:"Antofagasta",7250060:"Taltal",7250070:"Chanaral",7250080:"Caldera",7250090:"Huasco",7250100:"Isla de Pascua",7250110:"Coquimbo",7250120:"Los Vilos",7250125:"Quintero",7250130:"Juan Fernandez",7250140:"San Antonio",7250150:"Constitucion",7250170:"Talcahuano",7250210:"Corral",7250220:"Valdivia",7250230:"Puerto Montt",7250235:"Faro Punta Corona",7250240:"Ancud",7250250:"Castro",7250260:"Chaiten",7250270:"Quellon",7250280:"Melinka",7250290:"Faro Isla Guafo",7250294:"Puerto Aguirre",7250298:"Puerto Chacabuco",7250300:"Puerto Aysen",7250310:"Faro Raper",7250320:"San Pedro",7250330:"Puerto Eden",7250340:"Puerto Natales",7250350:"Faro Islote Evangelistas",7250360:"Faro Fairway",7250370:"Bahia Felix",7250380:"Punta Arenas",7250390:"Faro Delgada",7250400:"Faro Dungeness",7250410:"Faro Espiritu Santo",7250420:"Puerto Williams",7250430:"Wollaston",7250440:"Diego Ramirez",7250450:"Bahia Fildes/Antarctica",7250460:"Base A",7250470:"Bahia Paraiso/Antarctica",7251860:"Valparaiso Playa Ancha",7354750:"Guayaquil",7354752:"Esmeraldas",7354753:"Bahia",7354754:"Manta",7354755:"Salinas",7354756:"Puerto Bolivar",7354757:"Ayora",7354758:"Baquerizo Moreno",7600120:"Zorritos",7600121:"Paita",7600122:"Talara",7600123:"Pimentel",7600124:"Salaverry",7600125:"Callao",7600126:"Chimbote",7600127:"Supe",7600128:"Huacho",7600129:"Mollendo",7600130:"Pisco",7600131:"S Juan/S Nicolas",7600132:"Ilo",7600133:"Iquitos",7703870:"Montevideo"}};



