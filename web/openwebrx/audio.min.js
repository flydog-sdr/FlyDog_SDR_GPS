

/* web/openwebrx/audio.min.js (web/openwebrx/audio.js = Wed May  4 08:40:06 2022) */
var audio_stat_output_bufs,audio_stat_last_time,audio_running,audio_started,audio_last_output_offset,audio_mode_iq,audio_compression,audio_stat_input_epoch,audio_prepared_buffers,audio_prepared_buffers2,audio_prepared_seq,audio_prepared_flags,audio_prepared_smeter,audio_buffering,audio_convolver_running,audio_meas_dly,audio_meas_dly_start,resample_new,resample_old,resample_init1,resample_init2,resample_input_buffer,resample_input_available,resample_input_processed,resample_last_taps_delay,resample_output_buffer,resample_output_buffer2,resample_output_size,resample_taps,resample_taps_length,resample_last,resample_last2,audio_ext_adc_ovfl,audio_need_stats_reset,audio_change_LPF_latch,audio_change_freq_latch,audio_change_sq_UI_latch,audio_last_sq,audio_gain,comp_lpf_freq,comp_lpf_taps,comp_lpf_taps_length,audio_buffer_size,audio_buffer_min_length_sec,audio_buffer_max_length_sec,audio_data,audio_last_output_buffer,audio_last_output_buffer2,audio_silence_buffer,audio_stats_interval,audio_periodic_interval,audio_context,audio_output_rate,audio_last_is_local,audio_last_compression,audio_input_rate,audio_interpolation,audio_decimation,audio_resample_ratio,audio_transition_bw,audio_min_nbuf,audio_max_nbuf,audio_stat_output_epoch,audio_channels,audio_source,audio_watchdog,audio_change_LPF_delayed,audio_disconnected,audio_convolver,audio={d:!1,last_flags:0,trim_bufs:!1,lo_cut:0,hi_cut:0,SND_FLAG_LPF:1,SND_FLAG_ADC_OVFL:2,SND_FLAG_NEW_FREQ:4,SND_FLAG_MODE_IQ:8,SND_FLAG_COMPRESSED:16,SND_FLAG_RESTART:32,SND_FLAG_SQUELCH_UI:64,SND_FLAG_LITTLE_ENDIAN:128,SND_FLAG_SET_ACTIVE:256,SND_FLAG_CLR_ACTIVE:512,SND_FLAG_TUNE_ACK:1024,cur_flags2:0,_last:0},audio_periodic_interval_ms=1e3,audio_ext_sequence=0,audio_meas_dly_ena=0,audio_initial_connect=!1,audio_watchdog_restart=!1,audio_stat_input_size=0,audio_stat_total_input_size=0,audio_reconnect=0,audio_silence_count=0,audio_restart_count=0,audio_underrun_errors=0,audio_overrun_errors=0,audio_last_underruns=0,audio_last_reconnect=0,audio_last_restart_count=0,resample_new_default=!1,audio_adpcm={index:0,previousValue:0},audio_panner=null,audio_instance=0,audio_camping=0,audio_init_disconnect=0,audio_firefox_watchdog=0;function audio_camp(a,e,_,o){audio_camping=a?0:1,audio_init_disconnect=a,audio_init(e,_,o),audio_meas_dly_ena=audio_ext_sequence=0,audio_watchdog_restart=audio_initial_connect=!1}function audio_reset(){audio.trim_bufs=!0}function audio_init(a,e,_){if(audio_running=!1,kiwi_clearInterval(audio_periodic_interval),console.log("--------------------------"),audio.d&&console.log("AUDIO audio_init CALLED audio_init_disconnect="+audio_init_disconnect+" is_local="+a+" less_buffering="+e+" compression="+_),e=!1,audio.d&&console.log("AUDIO audio_init LAST audio_last_is_local="+audio_last_is_local+" audio_last_compression="+audio_last_compression),audio_last_is_local=a=null==a?audio_last_is_local:a,audio_last_compression=_=null==_?audio_last_compression:_,console.log("AUDIO audio_init FINAL is_local="+a+" less_buffering="+e+" compression="+_),!audio_init_disconnect&&null==audio_source||(audio.d&&console.log("AUDIO audio_init audio_disconnect"),audio_disconnect()),audio_mode_iq=audio_started=!1,audio_compression=!!_,audio_stat_input_epoch=-1,audio_prepared_buffers=[],audio_prepared_buffers2=[],audio_prepared_seq=[],audio_prepared_flags=[],audio_convolver_running=audio_buffering=!(audio_prepared_smeter=[]),audio_meas_dly_start=audio_meas_dly=audio_last_output_offset=0,resample_new=!kiwi_isMobile()&&resample_new_default,resample_old=!resample_new,resample_init2=resample_init1=!1,resample_input_buffer=[],resample_output_buffer=[],resample_output_buffer2=[],resample_taps=[],comp_lpf_freq=resample_last2=resample_last=resample_last_taps_delay=resample_input_processed=resample_input_available=0,comp_lpf_taps=[],comp_lpf_taps_length=255,audio_adpcm.index=0,audio_adpcm.previousValue=0,audio_change_sq_UI_latch=audio_change_freq_latch=audio_change_LPF_latch=!(audio_need_stats_reset=!(audio_ext_adc_ovfl=!1)),audio_last_sq=void 0,audio_firefox_watchdog=0,kiwi_clearInterval(audio_stats_interval),audio_init_disconnect)return audio.d&&console.log("AUDIO audio_init DISCONNECT"),audio_init_disconnect=0,!1;var o,i=0,u=kiwi_url_param("abuf",null,null),t=0;null!=u&&(_=u.split(","),t=parseFloat(_[0]),!isNaN(t)&&.25<=t&&t<=5?(console.log("AUDIO override abuf="+u),o=3*t,2<=_.length?(_=parseFloat(_[1]),!isNaN(_)&&.25<=_&&_<=5&&t<_&&(o=_)):o=3*t,audio_buffer_min_length_sec=t,audio_buffer_max_length_sec=o,audio_buffer_size=8192,i=9,o="abuf="):t=0),0==t&&(2==(i=e?a?2:1:0)?(audio_buffer_size=8192,audio_buffer_min_length_sec=.37,audio_buffer_max_length_sec=2,o="less buf, local"):1==i?(audio_buffer_size=8192,audio_buffer_min_length_sec=.74,audio_buffer_max_length_sec=3,o="less buf, remote"):0==i&&(audio_buffer_size=8192,audio_buffer_min_length_sec=.85,audio_buffer_max_length_sec=3.4,o="more buf")),audio_data=new Int16Array(audio_buffer_size),audio_last_output_buffer=new Float32Array(audio_buffer_size),audio_last_output_buffer2=new Float32Array(audio_buffer_size),audio_silence_buffer=new Float32Array(audio_buffer_size),console.log("AUDIO buffer_size="+audio_buffer_size+" buffering_scheme: "+o),audio_stats_interval=setInterval(audio_stats,1e3);try{window.AudioContext=window.AudioContext||window.webkitAudioContext,(audio_context=new AudioContext).sampleRate=44100,audio_output_rate=audio_context.sampleRate;try{audio_panner=audio_context.createStereoPanner(),audio_panner_ui_init()}catch(a){audio_panner=null}"LG"==kiwi_isSmartTV()&&(audio_gain=audio_context.createGain())}catch(a){return kiwi_serious_error("Your browser does not support Web Audio API, which is required for OpenWebRX to run. Please use an HTML5 compatible browser."),audio_context=null,!(audio_output_rate=0)}return audio_instance++,setTimeout(function(a){snd_send("SET little-endian")},1e4,audio_instance),!(audio_running=!0)}function audio_rate(a){if(0==(audio_input_rate=a))snd_send("SET x-DEBUG user's browser gave zero audio_input_rate?"),kiwi_serious_error("Audio initialization problem.");else if(0==audio_output_rate)snd_send("SET x-DEBUG user's browser doesn't support WebAudio"),snd_send("SET x-DEBUG "+navigator.userAgent),kiwi_serious_error("Browser doesn't support WebAudio:<br>"+navigator.userAgent+"<br><br>Please update to the latest version of your browser.");else if(resample_old)audio_interpolation=audio_output_rate/audio_input_rate,audio_decimation=1;else if((audio_interpolation=0)==audio_interpolation){for(var e=2;e<=1024;e++){var _=a*e/audio_output_rate,o=Math.floor(_);if(Math.abs(_-o)<1e-5)break}1024<e?(snd_send("SET UAR in="+a+" out="+audio_output_rate),kiwi_serious_error("Your system uses an audio output rate of "+audio_output_rate+" sps which we do not support.")):(audio_interpolation=e,audio_decimation=o)}0!=audio_interpolation?(audio_transition_bw=.001,audio_resample_ratio=audio_output_rate/audio_input_rate,snd_send("SET AR OK in="+a+" out="+audio_output_rate)):audio_resample_ratio=1,audio_min_nbuf=Math.ceil(audio_buffer_min_length_sec*audio_output_rate/audio_buffer_size),audio_max_nbuf=Math.ceil(audio_buffer_max_length_sec*audio_output_rate/audio_buffer_size),console.log("AUDIO audio_input_rate="+audio_input_rate+" audio_output_rate="+audio_output_rate),console.log("AUDIO min_length_sec="+audio_buffer_min_length_sec+"("+audio_min_nbuf+" bufs) max_length_sec="+audio_buffer_max_length_sec+"("+audio_max_nbuf+" bufs)")}function audio_start(){if(audio.d&&console.log("AUDIO audio_start"),null!=audio_context){audio_started=!0,audio_connect(0),audio_periodic_interval=setInterval(audio_periodic,audio_periodic_interval_ms);try{demodulator_analog_replace(init_mode)}catch(a){snd_send("SET x-DEBUG audio_start.demodulator_analog_replace: catch: "+a.toString())}}}function audio_disconnect(){audio.d&&console.log("AUDIO audio_disconnect"),audio_source&&(audio_disconnected=!0,audio_source.disconnect(),audio_source.onaudioprocess=null,audio_source=null),audio_convolver_running&&(audio_convolver.disconnect(),audio_convolver_running=!1),audio_watchdog&&(audio_watchdog.disconnect(),audio_watchdog.onaudioprocess=null,audio_watchdog=null),audio_panner&&audio_panner.disconnect()}function audio_connect_destination(a){"LG"==kiwi_isSmartTV()&&(audio_gain.gain.value=.3,a.connect(audio_gain),a=audio_gain),audio_panner?(a.connect(audio_panner),audio_panner.connect(audio_context.destination)):a.connect(audio_context.destination)}function audio_set_pan(a){if(audio_panner)try{audio_panner.pan.value=a}catch(a){}}function audio_connect(a){null!=audio_context&&(!audio_initial_connect&&a||(a||(audio_initial_connect=!0),a&&(audio_disconnect(),resample_init1=resample_init2=!1,audio_reconnect++,kiwi_log("AUDIO reconnect BUFFERING true"),audio_buffering=!0),audio_change_LPF_delayed=!(audio_stat_output_epoch=-1),(audio_source=audio_context.createScriptProcessor(audio_buffer_size,0,audio_channels)).onaudioprocess=audio_onprocess,audio_disconnected=!1,audio_convolver_running?(audio_source.connect(audio_convolver),audio_connect_destination(audio_convolver)):audio_connect_destination(audio_source),kiwi_isFirefox()&&((audio_watchdog=audio_context.createScriptProcessor(audio_buffer_size,audio_channels,0)).onaudioprocess=audio_watchdog_process,(audio_convolver_running?audio_convolver:audio_source).connect(audio_watchdog))))}function audio_watchdog_process(a){kiwi.muted||audio_buffering?audio_silence_count=0:(a=0==a.inputBuffer.getChannelData(0)[0],kiwi_gc_snd,16<(audio_silence_count=a?audio_silence_count+1:0)&&(audio_connect(1),audio_silence_count=0,audio_restart_count++,add_problem("FF silence"),kiwi_log("AUDIO FF SILENCE")))}function audio_onprocess(a){if(audio_firefox_watchdog++,!audio_disconnected){if(-1==audio_stat_output_epoch&&(audio_stat_output_epoch=(new Date).getTime(),audio_stat_output_bufs=0),audio_stat_output_bufs++,audio_started&&0==audio_prepared_buffers.length&&(audio_underrun_errors++,audio_buffering=!0),!audio_started||audio_buffering)return audio_need_stats_reset=!0,a.outputBuffer.copyToChannel(audio_silence_buffer,0),void(2==audio_channels&&a.outputBuffer.copyToChannel(audio_silence_buffer,1));a.outputBuffer.copyToChannel(audio_prepared_buffers.shift(),0),2==audio_channels&&a.outputBuffer.copyToChannel(audio_prepared_buffers2.shift(),1),audio_ext_sequence=audio_prepared_seq.shift(),audio_change_LPF_delayed&&(audio_recompute_LPF(0),audio_change_LPF_delayed=!1),owrx.sMeter_dBm_biased=audio_prepared_smeter.shift()/10,owrx.sMeter_dBm=owrx.sMeter_dBm_biased-SMETER_BIAS;var e=audio_prepared_flags.shift();audio_ext_adc_ovfl=!!(e&audio.SND_FLAG_ADC_OVFL),e&audio.SND_FLAG_LPF&&(audio_change_LPF_delayed=!0);a=!!(e&audio.SND_FLAG_SQUELCH_UI);a!=audio_last_sq&&isDefined(squelch_action)&&(setTimeout(function(a){squelch_action(a)},1,a),audio_last_sq=a),e&audio.SND_FLAG_TUNE_ACK&&setTimeout(function(a){w3_call("ale_2g_tune_ack",a)},10,audio.tune_freq),audio_meas_dly_ena&&audio_meas_dly_start&&e&audio.SND_FLAG_NEW_FREQ&&(audio_meas_dly=(new Date).getTime()-audio_meas_dly_start,kiwi_log("AUDIO dly="+audio_meas_dly),audio_meas_dly_start=0)}}var audio_watchdog_restart_cnt=0;function audio_periodic(){audio_started&&audio_prepared_buffers.length&&0==audio_firefox_watchdog&&kiwi_isFirefox()&&!cfg.disable_recent_changes&&(add_problem("FF watchdog"),console.log("AUDIO FF WATCHDOG Q"+audio_prepared_buffers.length+" WD="+audio_firefox_watchdog+" ============================================"),audio_init(0,null,!1,null),audio_watchdog_restart=audio_initial_connect=!0,snd_send("SET reinit"));for(var a=!1;audio_prepared_buffers.length>audio_max_nbuf;)a=!0,audio_prepared_buffers.shift(),2==audio_channels&&audio_prepared_buffers2.shift(),audio_prepared_seq.shift(),audio_prepared_flags.shift(),audio_prepared_smeter.shift();a&&(add_problem("audio overrun"),audio_overrun_errors++),audio_last_underruns!=audio_underrun_errors&&(add_problem("audio underrun"),snd_send("SET underrun="+audio_underrun_errors),audio_last_underruns=audio_underrun_errors)}function audio_adpcm_state(a,e){audio_adpcm.index=a,audio_adpcm.previousValue=e,audio_camping=2}function audio_recv(a){if(audio_running){var e=new Uint8Array(a,0,8),_=e[3],o=e[7]<<24|e[6]<<16|e[5]<<8|e[4];if(!(1==audio_camping&&_&audio.SND_FLAG_COMPRESSED)){var i,u,t=new Uint8Array(a,8,2),e=t[0]<<8|t[1],t=_&audio.SND_FLAG_MODE_IQ,d=new DataView(a,t?20:10),a=d.byteLength;if(audio_watchdog_restart){if(!(_&audio.SND_FLAG_RESTART))return;audio_watchdog_restart=!1,audio_prepared_buffers=[],audio_prepared_buffers2=[],audio_prepared_seq=[],audio_prepared_flags=[],audio_prepared_smeter=[],resample_old=audio_mode_iq?!(resample_new=!1):(audio_adpcm.index=audio_adpcm.previousValue=0,!(resample_new=!kiwi_isMobile()&&resample_new_default)),audio_connect(1)}else audio_mode_iq=t?(audio_mode_iq||(audio_prepared_buffers=[],audio_prepared_buffers2=[],audio_prepared_seq=[],audio_prepared_flags=[],resample_old=!(resample_new=!(audio_prepared_smeter=[])),audio_mode_iq=!0,audio_channels=2,audio.d&&console.log("AUDIO !IQ -> IQ transition"),audio_connect(1)),audio_last_compression=audio_compression=!1,!0):(u=!!(_&audio.SND_FLAG_COMPRESSED),!audio_mode_iq&&audio_compression==u||(audio_prepared_buffers=[],audio_prepared_buffers2=[],audio_prepared_seq=[],audio_prepared_flags=[],audio_prepared_smeter=[],audio_adpcm.index=audio_adpcm.previousValue=0,resample_new=!kiwi_isMobile()&&resample_new_default,resample_old=!resample_new,audio.d&&(audio_mode_iq?console.log("AUDIO IQ -> !IQ transition, compressed="+u):console.log("AUDIO !IQ, compression change="+(audio_compression!=u)+" compressed="+u)),audio_mode_iq=!1,audio_last_compression=audio_compression=u,audio_connect(audio_channels=1)),audio_last_compression=audio_compression=u,!1);if(audio_channels=audio_mode_iq?2:1,audio_compression)audio.d&&console.log("AC Q"+audio_prepared_buffers.length+" #"+audio_channels),decode_ima_adpcm_e8_i16(d,audio_data,a,audio_adpcm),i=2*a;else for(audio.d&&(t?console.log("ANC IQ Q"+audio_prepared_buffers.length+"/"+audio_prepared_buffers2.length+" #"+audio_channels):console.log("ANC Q"+audio_prepared_buffers.length+" #"+audio_channels)),i=a/2,s=0;s<i;s++)audio_data[s]=d.getInt16(2*s,!!(_&audio.SND_FLAG_LITTLE_ENDIAN));if(audio_prepare(audio_data,i,o,_,e),audio_started||audio_prepared_buffers.length>audio_min_nbuf&&audio_start(),audio_need_stats_reset&&audio_stats_reset(),audio_stat_input_size+=i,audio_stat_total_input_size+=i,extint_audio_data(audio_data,i),wf.audioFFT_active&&wf_audio_FFT(audio_data,i),window.recording&&0==audio_last_sq){for(var r=audio_mode_iq?1024:u?2048:512,s=0;s<r;++s)window.recording_meta.data.setInt16(window.recording_meta.offset,audio_data[s],!0),window.recording_meta.offset+=2;window.recording_meta.total_size+=2*r,65536==window.recording_meta.offset&&(window.recording_meta.buffers.push(new ArrayBuffer(65536)),window.recording_meta.data=new DataView(window.recording_meta.buffers[window.recording_meta.buffers.length-1]),window.recording_meta.offset=0)}}}}function audio_recv_flags2(a){var e=a.split(":");switch(e[0]){case"active":var _=+e[1];console.log("$ active="+_),audio.cur_flags2|=_?audio.SND_FLAG_SET_ACTIVE:SND_FLAG_CLR_ACTIVE;break;case"tune_ack":audio.tune_freq=+e[1],console.log("$ tune_ack="+audio.tune_freq),audio.cur_flags2|=audio.SND_FLAG_TUNE_ACK}}var audio_push_ct=0;function audio_prepare(a,e,_,o,i){function u(){audio_prepared_buffers.push(audio_last_output_buffer),2==audio_channels&&audio_prepared_buffers2.push(audio_last_output_buffer2),audio_prepared_seq.push(_),audio_change_LPF_latch&&(audio_change_LPF_latch=!1,o|=audio.SND_FLAG_LPF),audio_change_freq_latch&&(audio_change_freq_latch=!1,o|=audio.SND_FLAG_NEW_FREQ),audio_change_sq_UI_latch&&(audio_change_sq_UI_latch=!1,o|=audio.SND_FLAG_SQUELCH_UI),audio.cur_flags2&&(o|=audio.cur_flags2,audio.cur_flags2=0),audio_prepared_flags.push(o),audio_prepared_smeter.push(i),audio_last_output_offset=0,audio_last_output_buffer=new Float32Array(audio_buffer_size),2==audio_channels&&(audio_last_output_buffer2=new Float32Array(audio_buffer_size))}function t(a,e,_,o,i){for(var u=0;u<i;u++)a[e+u]=_[o+u]}var d,r,s,n,l=resample_new&&audio_compression&&comp_lpf_taps_length;if(0!=e){if(1!=audio_resample_ratio){if(resample_init1||((resample_taps_length=Math.round(4/audio_transition_bw))%2==0&&resample_taps_length++,rational_resampler_get_lowpass_f(resample_taps,resample_taps_length,audio_interpolation,audio_decimation),resample_init1=!0),!resample_init2&&resample_init1&&(l||resample_old)&&null!=audio_source&&(audio_recompute_LPF(1),l=comp_lpf_taps,n=comp_lpf_taps_length,(audio_convolver=audio_context.createConvolver()).normalize=!1,audio_reload_convolver_buffer(l,n),audio.d&&console.log("AUDIO splice in convolver"),audio_source.disconnect(),audio_source.connect(audio_convolver),audio_connect_destination(audio_convolver),kiwi_isFirefox()&&audio_convolver.connect(audio_watchdog),resample_init2=audio_convolver_running=!0),resample_old)if(2==audio_channels){resample_output_size=Math.round(e/2*audio_resample_ratio);var p,f=1/audio_resample_ratio,c=0,m=0;for(w=0;w<resample_output_size;w++)g=a[2*c],h=resample_last,resample_output_buffer[w]=(g-h)*m+h,p=a[2*c+1],h=resample_last2,resample_output_buffer2[w]=(p-h)*m+h,1<=(m+=f)&&(--m,resample_last=g,resample_last2=p,c++);resample_last=g,resample_last2=p}else{resample_output_size=Math.round(e*audio_resample_ratio);var g,h,f=1/audio_resample_ratio,c=0,m=0;for(w=0;w<resample_output_size;w++)g=a[c],h=resample_last,resample_output_buffer[w]=(g-h)*m+h,1<=(m+=f)&&(--m,resample_last=g,c++);resample_last=g}else 0!=resample_input_processed&&(t(resample_input_buffer,0,resample_input_buffer,resample_input_processed,n=resample_input_available-resample_input_processed),resample_input_available=n,resample_input_processed=0),t(resample_input_buffer,resample_input_available,a,0,e),resample_input_available+=e,2==audio_channels?rational_resampler_cc(resample_input_buffer,resample_output_buffer,resample_output_buffer2,resample_input_available,audio_interpolation,audio_decimation,resample_taps,resample_taps_length,resample_last_taps_delay):rational_resampler_ff(resample_input_buffer,resample_output_buffer,resample_input_available,audio_interpolation,audio_decimation,resample_taps,resample_taps_length,resample_last_taps_delay);d=resample_output_buffer,r=resample_output_buffer2,s=resample_output_size}else d=a,s=e;if(o&audio.SND_FLAG_LPF&&(audio_change_LPF_latch=!0),o&audio.SND_FLAG_NEW_FREQ||audio.trim_bufs){audio_change_freq_latch=!0,audio.trim_bufs=!1;for(var e=audio_prepared_buffers.length,b=audio_min_nbuf;audio_prepared_buffers.length>b;)audio_prepared_buffers.pop(),2==audio_channels&&audio_prepared_buffers2.pop(),audio_prepared_seq.pop(),audio_prepared_flags.pop(),audio_prepared_smeter.pop()}if(o&audio.SND_FLAG_SQUELCH_UI&&(audio_change_sq_UI_latch=!0),audio_last_output_offset+s<=audio_buffer_size){if(2==audio_channels)for(var w=0;w<s;w++)audio_last_output_buffer[w+audio_last_output_offset]=d[w]/32768*kiwi.volume_f,audio_last_output_buffer2[w+audio_last_output_offset]=r[w]/32768*kiwi.volume_f;else for(w=0;w<s;w++)audio_last_output_buffer[w+audio_last_output_offset]=d[w]/32768*kiwi.volume_f;(audio_last_output_offset+=s)==audio_buffer_size&&u()}else{var v=audio_buffer_size-audio_last_output_offset,A=s-v;if(2==audio_channels)for(var w=0;w<audio_buffer_size-audio_last_output_offset;w++)audio_last_output_buffer[w+audio_last_output_offset]=d[w]/32768*kiwi.volume_f,audio_last_output_buffer2[w+audio_last_output_offset]=r[w]/32768*kiwi.volume_f;else for(w=0;w<audio_buffer_size-audio_last_output_offset;w++)audio_last_output_buffer[w+audio_last_output_offset]=d[w]/32768*kiwi.volume_f;u();do{for(w=0;w<A;w++){if(w==audio_buffer_size){u();break}audio_last_output_buffer[w]=d[w+v]/32768*kiwi.volume_f,2==audio_channels&&(audio_last_output_buffer2[w]=r[w+v]/32768*kiwi.volume_f)}}while(v+=w,A-=w);audio_last_output_offset+=w}audio_buffering&&audio_prepared_buffers.length>audio_min_nbuf&&(audio_buffering=!1)}}try{AudioBuffer.prototype.copyToChannel||(AudioBuffer.prototype.copyToChannel=function(a,e){for(var _=this.getChannelData(e),o=0;o<a.length;o++)_[o]=a[o]})}catch(a){console.log("CATCH: AudioBuffer.prototype.copyToChannel")}function audio_stats_reset(){audio_stat_input_epoch=(new Date).getTime(),audio_stat_last_time=audio_stat_input_epoch,audio_stat_input_size=audio_stat_total_input_size=0,audio_need_stats_reset=!1}function audio_stats(){var a,e,_;-1!=audio_stat_input_epoch&&-1!=audio_stat_output_epoch&&(a=((e=(new Date).getTime())-audio_stat_last_time)/1e3,_=audio_stat_total_input_size/(((audio_stat_last_time=e)-audio_stat_input_epoch)/1e3),e=audio_stat_output_bufs*audio_buffer_size/((e-audio_stat_output_epoch)/1e3),_="Audio: network "+(audio_stat_input_size/a).toFixed(0)+" sps ("+_.toFixed(0)+" avg), output "+e.toFixed(0)+" sps",_+=", Qlen "+audio_prepared_buffers.length,audio_underrun_errors&&(_+=", underruns "+audio_underrun_errors.toString()),audio_restart_count&&(_+=", restart "+audio_restart_count.toString()),w3_innerHTML("id-msg-audio",_),audio.d&&console.log(_),isNaN(e)&&(e=0),w3_innerHTML("id-status-audio",w3_text(optbar_prefix_color,"WF"),w3_text("",kiwi.wf_fps.toFixed(0)+" fps"),w3_text(optbar_prefix_color,"Audio"),w3_text("",(e/1e3).toFixed(1)+"k, Qlen "+audio_prepared_buffers.length)),audio_stat_input_size=0)}function audio_recompute_LPF(a,e,_){isDefined(e)&&isDefined(_)&&(audio.lo_cut=Math.abs(e),audio.hi_cut=Math.abs(_)),audio_camping?(e=audio.lo_cut,_=audio.hi_cut):isDefined(demodulators[0])?(_=Math.abs(demodulators[0].high_cut),isNaN(_)&&console.log(demodulators[0]),e=Math.abs(demodulators[0].low_cut)):(e=0,_=4e3);e=Math.max(_,e);!a&&e==comp_lpf_freq||(firdes_lowpass_f(comp_lpf_taps,comp_lpf_taps_length,e/audio_output_rate),comp_lpf_freq=e,audio_convolver_running&&audio_reload_convolver_buffer(comp_lpf_taps,comp_lpf_taps_length))}function audio_reload_convolver_buffer(a,e){var _=audio_context.createBuffer(2,e,audio_output_rate),e=_.getChannelData(0);e.set(a),(e=_.getChannelData(1)).set(a),audio_convolver.buffer=_}function rational_resampler_ff(a,e,_,o,i,u,t,d){for(var r,s,n=Math.round(_*o/i),l=0;l<n&&(r=Math.floor((l*i+o-1-d)/o),s=Math.floor((d+r*o-l*i)%o),!(_<r+t/o+1));l++){for(var p=Math.floor((t-s)/o),f=0,c=0;c<p;c++)f+=a[r+c]*u[s+c*o];e[l]=f*o}resample_input_processed=r,resample_output_size=l,resample_last_taps_delay=s}function rational_resampler_cc(a,e,_,o,i,u,t,d,r){console.log("WARNING rational_resampler_cc() not working yet!")}function rational_resampler_get_lowpass_f(a,e,_,o){_=1/_,o=1/o;firdes_lowpass_f(a,e,(_<o?_:o)/2)}function firdes_lowpass_f(a,e,_){var o=Math.floor(e/2);for(a[o]=2*Math.PI*_*firdes_wkernel_hamming(0),u=1;u<=o;u++)a[o-u]=a[o+u]=Math.sin(2*Math.PI*_*u)/u*firdes_wkernel_hamming(u/o);for(var i=0,u=0;u<e;u++)i+=a[u];for(u=0;u<e;u++)a[u]/=i}function firdes_wkernel_hamming(a){return a=.5+a/2,.54-.46*Math.cos(2*Math.PI*a)}



