

/* web/pkgs/js/graph.min.js */
function graph_init(r,l){return gr={},gr.auto=1,gr.dBm=0,gr.db_units="dB",gr.speed=1,gr.marker=-1,gr.x_tick=0,gr.threshold=0,gr.averaging=!1,gr.timestamp=!1,gr.avg_dB=0,gr.divider=!1,gr.max=0,gr.min=0,gr.hi=0,gr.lo=0,gr.goalH=0,gr.goalL=0,gr.scroll=0,gr.scaleWidth=60,gr.hysteresis=15,gr.padding_tb=0,gr.xi=0,gr.secs_last=0,gr.redraw_scale=!1,gr.clr_color="mediumBlue",gr.bg_color="ghostWhite",gr.grid_color="lightGrey",gr.scale_color="white",gr.last_last=0,gr.cv=r,gr.ct=r.ctx,gr.auto=1,gr.dBm=w3_opt(l,"dBm",0),gr.speed=w3_opt(l,"speed",1),gr.averaging=w3_opt(l,"averaging",!1),gr.timestamp=w3_opt(l,"timestamp",!1),gr.plot_color=w3_opt(l,"color","black"),gr.dBm?(gr.padding_tb=20,gr.db_units="dBm"):(gr.db_units="dB",gr.padding_tb=0),gr}function graph_clear(r){var l=r.ct;l.fillStyle=r.clr_color,l.fillRect(0,0,r.cv.width-r.scaleWidth,r.cv.height),r.x_tick=0,r.xi=r.cv.width-r.scaleWidth,graph_rescale(r)}function graph_rescale(r){r.redraw_scale=!0}function graph_mode(r,l,e,t){r.auto="auto"==l?1:0,r.auto||(r.max=e,r.min=t),graph_rescale(r)}function graph_speed(r,l){l<1&&(l=1),r.speed=l}function graph_marker(r,l){r.marker=l}function graph_annotate(r,l){r.divider=l}function graph_threshold(r,l){r.threshold=l}function graph_averaging(r,l){r.averaging=l,r.avg_dB=0}function graph_timestamp(r,l){r.timestamp=l}function graph_plot(r,l,e){var t=w3_opt(e,"color",r.plot_color),a=w3_opt(e,"line",!1),i=r.cv,o=r.ct,g=i.width-r.scaleWidth,c=i.height,d=g-r.xi,s=r.hi-r.lo,_=function(l){var e=(l-r.lo)/s;return Math.round(c-e*c)},n=function(r){return 10*Math.ceil(r/10)},h=!1;if(r.redraw_scale||r.auto){if(r.auto){var f=.25/r.speed;r.goalH=r.goalH>l+r.padding_tb?r.goalH-f:l+r.padding_tb,r.goalL=r.goalL<l-r.padding_tb?r.goalL+f:l-r.padding_tb}else r.goalH=r.max,r.goalL=r.min,h=!0;if(r.goalL>r.lo+r.hysteresis||r.goalL<r.lo||h){var p=function(r){return 10*Math.floor(r/10)}(r.goalL)-5,m=r.hi-p;if(p<=r.lo){var u=s/m;d&&(o.drawImage(i,r.xi,0,d,c,r.xi,0,d,c*u),o.fillStyle=r.bg_color,o.fillRect(r.xi,Math.floor(u*c),d,c*(1-u)+1))}else{var v=m/s;d&&o.drawImage(i,r.xi,0,d,c*v,r.xi,0,d,c)}r.lo=p,s=m,r.auto&&(r.redraw_scale=!0)}if(r.goalH>r.hi||r.goalH<r.hi-r.hysteresis||h){var x=n(r.goalH)+5;m=x-r.lo;if(x>=r.hi){u=s/m;d&&(o.drawImage(i,r.xi,0,d,c,r.xi,c*(1-u),d,c*u),o.fillStyle=r.bg_color,o.fillRect(r.xi,0,d,Math.ceil(c*(1-u))))}else{v=m/s;d&&o.drawImage(i,r.xi,c*(1-v),d,c*v,r.xi,0,d,c)}r.hi=x,s=x-r.lo,r.auto&&(r.redraw_scale=!0)}}if(r.redraw_scale){o.fillStyle=r.clr_color,o.fillRect(g,0,r.scaleWidth,c),o.fillStyle=r.scale_color,o.font="10px Verdana";for(var w=r.lo;(w=n(w))<=r.hi;w++)o.fillText(w+" "+r.db_units,g+2,_(w)+4,r.scaleWidth);r.redraw_scale=!1}var k=!1;if(++r.scroll>=r.speed){r.scroll=0,r.xi>0&&r.xi--,o.drawImage(i,1,0,g-1,c,0,0,g-1,c),r.date=new Date;var b=r.date.getTime()/1e3,y=Math.floor(b/r.marker),S=Math.floor(r.secs_last/r.marker);if(-1==r.marker||y==S){o.fillStyle=r.bg_color,o.fillRect(g-1,0,1,c),o.fillStyle=r.grid_color;for(w=r.lo;(w=n(w))<=r.hi;w++)o.fillRect(g-1,_(w),1,1)}else{var B=r.grid_color;r.timestamp&&0==r.x_tick&&(r.time_mark=r.date,r.x_tick=1,B="blue"),r.secs_last=b,o.fillStyle=B,o.fillRect(g-1,0,1,c)}if(75==r.x_tick){var R=0==wf.ts_tz?r.time_mark.toUTCString().substr(17,8):r.time_mark.toString().substr(16,8),H=g-70+o.measureText(R).width/2;w3_fillText(o,H,c-10,R,"black","14px Arial",1)}if(300==r.x_tick&&(r.x_tick=0),r.x_tick&&r.x_tick++,0!=r.divider){var L=o.fillStyle;o.fillStyle=r.divider,o.fillRect(g-1,0,1,c),r.divider=!1,o.fillStyle=L}r.threshold&&(o.fillStyle="red",o.fillRect(g-1,_(r.threshold),1,1)),k=!0}if(r.averaging){var M=(r.avg_dB*(r.speed-1)+l)/r.speed;l=r.avg_dB=M}var T=null;if(!r.averaging||k||0!=a){var W=_(l);0!=a?(o.strokeStyle=t,o.beginPath(),o.moveTo(g-1,a),o.lineTo(g,W),T=W,o.stroke()):(o.fillStyle=t,o.fillRect(g-1,W,1,1))}return T}


