

/* web/kiwi/kiwi_util.min.js (web/kiwi/kiwi_util.js = Mon Jun  6 14:33:37 2022) */
function isUndefined(e){return void 0===e}function isDefined(e){return void 0!==e}function isNull(e){return null===e}function isNumber(e){return"number"==typeof e&&!isNaN(e)}function isBoolean(e){return"boolean"==typeof e}function isString(e){return"string"==typeof e}function isArray(e){return Array.isArray(e)}function isFunction(e){return"function"==typeof e}function isObject(e){return"object"==typeof e}function isArg(e){return!isUndefined(e)&&!isNull(e)}function kiwi_typeof(e){return isNull(e)?"null":isArray(e)?"array":typeof e}function ifString(e,i){return isString(e)?e:i}try{String.prototype.includes||(String.prototype.includes=function(e){return 0<=this.indexOf(e)})}catch(e){console.log("kiwi_util: String.prototype.includes")}try{String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0==this.indexOf(e)})}catch(e){console.log("kiwi_util: String.prototype.startsWith")}try{String.prototype.endsWith||(String.prototype.endsWith=function(e,i){return(void 0===i||i>this.length)&&(i=this.length),this.substring(i-e.length,i)===e})}catch(e){console.log("kiwi_util: String.prototype.endsWith")}var kiwi_iOS,kiwi_MacOS,kiwi_linux,kiwi_Windows,kiwi_android,kiwi_safari,kiwi_firefox,kiwi_chrome,kiwi_opera,kiwi_smartTV,kiwi_util={};function kiwi_is_iOS(){return kiwi_iOS}function kiwi_isMacOS(){return kiwi_MacOS}function kiwi_isWindows(){return kiwi_Windows}function kiwi_isLinux(){return kiwi_linux}function kiwi_isAndroid(){return kiwi_android}function kiwi_isSmartTV(){return kiwi_smartTV}function kiwi_isMobile(){return force_mobile||kiwi_is_iOS()||kiwi_isAndroid()||"Samsung"==kiwi_isSmartTV()||mobile_laptop_test}function kiwi_isSafari(){return kiwi_safari?kiwi_safari[1]:NaN}function kiwi_isFirefox(){return kiwi_firefox?kiwi_firefox[1]:NaN}function kiwi_isChrome(){return kiwi_chrome?kiwi_chrome[1]:NaN}function kiwi_isOpera(){return kiwi_opera?kiwi_opera[1]:NaN}var kiwi_version_fail=!(document.onreadystatechange=function(){var e;"complete"==document.readyState&&(e=navigator.userAgent,console.log(e),kiwi_iOS=e.includes("iPhone")||e.includes("iPad"),kiwi_MacOS=e.includes("OS X"),kiwi_linux=e.includes("Linux"),kiwi_Windows=e.includes("Win"),kiwi_android=e.includes("Android"),kiwi_safari=/safari\/([0-9]+)/i.exec(e),kiwi_browserVersion=/version\/([0-9]+)/i.exec(e),kiwi_firefox=/firefox\/([0-9]+)/i.exec(e),kiwi_chrome=/chrome\/([0-9]+)/i.exec(e),kiwi_opera=(kiwi_opera=/opera\/([0-9]+)/i.exec(e))||/OPR\/([0-9]+)/i.exec(e),(kiwi_smartTV=(kiwi_smartTV=e.includes("SmartTV"))||e.includes("SMART-TV"))&&(e.includes("Samsung")?kiwi_smartTV="Samsung":e.includes("LG")&&(kiwi_smartTV="LG")),console.log("MacOS="+kiwi_MacOS+" Linux="+kiwi_linux+" Windows="+kiwi_Windows+" iOS="+kiwi_iOS+" Android="+kiwi_android+" SmartTV="+kiwi_smartTV),kiwi_opera?kiwi_chrome=kiwi_safari=null:kiwi_chrome?kiwi_safari=null:kiwi_safari&&kiwi_browserVersion&&(kiwi_safari[1]=kiwi_browserVersion[1]),console.log("Safari="+kiwi_isSafari()+" Firefox="+kiwi_isFirefox()+" Chrome="+kiwi_isChrome()+" Opera="+kiwi_isOpera()),"undefined"!=typeof kiwi_check_js_version?kiwi_ajax("/VER","kiwi_version_cb"):"undefined"!=typeof kiwi_bodyonload&&kiwi_bodyonload(""))});function kiwi_version_cb(e){version_maj=e.maj,version_min=e.min;var i="";kiwi_check_js_version.forEach(function(e){e.VERSION_MAJ==version_maj&&e.VERSION_MIN==version_min||(0==kiwi_version_fail&&(i="Your browser is trying to use incorrect versions of the KiwiSDR Javascript files.<br>Please clear your browser cache and try again.<br>Or click the button below to continue anyway.<br><br>v"+version_maj+"."+version_min+": KiwiSDR server<br>",kiwi_version_fail=!0),i+="v"+e.VERSION_MAJ+"."+e.VERSION_MIN+": "+e.file+"<br>")}),kiwi_version_fail&&(i+="<br>"+w3_button("w3-css-yellow","Continue anyway","kiwi_version_continue_cb")),kiwi_bodyonload(i)}function kiwi_version_continue_cb(){seriousError=!1,kiwi_bodyonload("")}function ord(e,i){return isString(i)?e.charCodeAt(0)-i.charCodeAt(0):e.charCodeAt(0)}function chr(e){return String.fromCharCode(e)}function sq(e){return"'"+e+"'"}function dq(e){return'"'+e+'"'}function dqc(e){return'"'+e+'":'}function paren(e){return"("+e+")"}function plural(e,i){return 1==e?i:i+"s"}function arrayBufferToString(i){try{for(var e=new Uint8Array(i),t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r])}catch(e){console.log(i),console.log(e),kiwi_trace("arrayBufferToString"),t=null}return t}function arrayBufferToStringLen(e,i){var t=new Uint8Array(e),r=String();i=Math.min(i,t.length);for(var n=0;n<i;n++)r+=String.fromCharCode(t[n]);return r}function kiwi_dup_array(e){return e.slice()}function kiwi_dedup_array(e,t){var r=[];return e.forEach(function(e,i){t&&t(e)||r.includes(e)||r.push(e)}),r}function kiwi_shallow_copy(e){return Object.assign({},e)}function kiwi_deep_copy(e){return JSON.parse(JSON.stringify(e))}function kiwi_bitReverse(e,t){if(0==e)return 0;var r=0;for(i=0;i<t;i++)r|=(e>>i&1)<<t-1-i;return r>>>0}function kiwi_bitCount(e){return 0==e?0:e.toString(2).match(/1/g).length}function getFirstChars(e,i){arrayBufferToStringLen(e,i)}function kiwi_inet4_d2h(e,i){var t=e.split(".");if(4!=t.length)return null;function r(e){return!isNumber(e=parseInt(e))||e<0||255<e?null:e}var n,o;if(null==(n=r(t[0])))return null;if(null==(o=r(t[1])))return null;if(null==(e=r(t[2])))return null;if(null==(t=r(t[3])))return null;t|=n<<24|o<<16|e<<8;return i&&(kiwi_ip_10_lo<=t&&t<=kiwi_ip_10_hi||kiwi_ip_172_16_lo<=t&&t<=kiwi_ip_172_16_hi||kiwi_ip_192_168_lo<=t&&t<=kiwi_ip_192_168_hi||t==kiwi_ip_loopback)?null:t}var kiwi_ip_10_lo=kiwi_inet4_d2h("10.0.0.0"),kiwi_ip_10_hi=kiwi_inet4_d2h("10.255.255.255"),kiwi_ip_172_16_lo=kiwi_inet4_d2h("172.16.0.0"),kiwi_ip_172_16_hi=kiwi_inet4_d2h("172.31.255.255"),kiwi_ip_192_168_lo=kiwi_inet4_d2h("192.168.0.0"),kiwi_ip_192_168_hi=kiwi_inet4_d2h("192.168.255.255"),kiwi_ip_loopback=kiwi_inet4_d2h("127.0.0.1");function kiwi_h2n_32(e,i){var t;switch(i){case 0:t=e>>24;break;case 1:t=e>>16;break;case 2:t=e>>8;break;case 3:t=e;break;default:t=0}return 255&t}function kiwi_ip_str(e){var i="";return isNumber(e)?i=kiwi_h2n_32(e,0)+"."+kiwi_h2n_32(e,1)+"."+kiwi_h2n_32(e,2)+"."+kiwi_h2n_32(e,3):isArray(e)?i=e[3]+"."+e[2]+"."+e[1]+"."+e[0]:isObject(e)&&(i=e.a+"."+e.b+"."+e.c+"."+e.d),i}function isHexDigit(e){return-1<"0123456789ABCDEFabcdef".indexOf(e)}Number.prototype.leadingZeros=function(e){var i=String(this);for(isNumber(e)||(e=2);i.length<e;)i="0"+i;return i},String.prototype.leadingZeros=function(e){var i=String(this);for(isNumber(e)||(e=2);i.length<e;)i="0"+i;return i},Number.prototype.fieldWidth=function(e){var i=String(this);if(!isNumber(e))return i;for(;i.length<e;)i=" "+i;return i},String.prototype.fieldWidth=function(e){var i=String(this);if(!isNumber(e))return i;for(;i.length<e;)i=" "+i;return i},String.prototype.filterInt=function(){var e=String(this);return/^(\-|\+)?([0-9]+|Infinity)$/.test(e)?Number(e):NaN},String.prototype.withSign=function(){return Number(this)<0?this:"+"+this},String.prototype.positiveWithSign=function(){return Number(this)<=0?this:"+"+this},Number.prototype.toHex=function(e){var i=(e=!isNumber(e)?0:e)<0?0:1;e=Math.abs(e);for(var t=Number(this),r=(t>>>=0).toString(16);r.length<e;)r="0"+r;return r=i?"0x"+r:r},Number.prototype.toFixedNZ=function(e){for(var i=Number(this).toFixed(e);i.endsWith("0");)i=i.slice(0,-1);return i=i.endsWith(".")?i.slice(0,-1):i},Number.prototype.toUnits=function(){var e=Number(this);return e<1e3?e.toString():e<1e6?(e/1e3).toFixed(1)+"k":e<1e9?(e/1e6).toFixed(1)+"M":(e/1e9).toFixed(1)+"G"},String.prototype.parseFloatWithUnits=function(e,i){var t=String(this),r=parseFloat(t);return isNaN(r)?NaN:(e&&!e.includes("k")||new RegExp("([-0-9.]*k)").test(t)&&(r*=1e3,i&&(r*=i)),e&&!e.includes("M")||new RegExp("([-0-9.]*M)").test(t)&&(r*=1e6,i&&(r*=i)),r)},Number.prototype.withSign=function(){var e=Number(this),i=e.toString();return e<0?i:"+"+i};var kHz=function(e){return(e/1e3).toFixed(3)+"k"};function kiwi_setTimeout(e,i,t){return e(t),setTimeout(e,i,t)}function kiwi_clearTimeout(e){try{clearTimeout(e)}catch(e){}}function kiwi_setInterval(e,i,t){return e(t),setInterval(e,i,t)}function kiwi_clearInterval(e){try{clearInterval(e)}catch(e){}}var littleEndian=function(){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}();function _nochange(e){if(0!=arguments.length)return void 0===e}function _default(e){return 0==arguments.length?NaN:isNaN(e)}function _change(e){return!_nochange(e)&&!_default(e)}function console_log(){for(var e,i=0;i<arguments.length;i++){var t=arguments[i];0==i?e=t+": ":e+="arg"+(i-1)+"="+t+" "}console.log("CONSOLE_LOG "+e)}function console_log_fqn(){for(var e,i=0;i<arguments.length;i++){var t,r=arguments[i];if(0==i)e=r+": ";else{try{t=getVarFromString(r)}catch(e){t="[not defined]"}var n=r.lastIndexOf(".");e+=(-1==n?r:r.substr(n+1))+"="+t+" "}}console.log("FQN "+e)}function console_log_dbgUs(){if(dbgUs){s="";for(var e=0;e<arguments.length;e++)s+=arguments[e].toString();console.log(s)}}function kiwi_log(e){setTimeout(function(e){console.log(e)},1,e)}function kiwi_trace_log(e){setTimeout(function(e){kiwi_trace(e)},1,e)}function canvas_log(e){isUndefined(owrx.news_acc_s)&&(owrx.news_acc_s="<br>"),"\f"==e?owrx.news_acc_s="<br>":"$"==e.charAt(0)?owrx.news_acc_s+="<br>"+e:owrx.news_acc_s+=("<br>"!=owrx.news_acc_s?" | ":"")+e,extint_news(owrx.news_acc_s)}function canvas_log2(e){kiwi_isMobile()&&toggle_or_set_hide_bars(owrx.HIDE_BANDBAR),w3_innerHTML("id-rx-title",kiwi.log2_seq+": "+e),kiwi.log2_seq++}function kiwi_pathToSelector(e){if(!e||!e.outerHTML)return null;for(var i;e.parentElement;){if(!(t=e.localName))break;var t=t.toLowerCase(),r=e.parentElement,n=[];if(r.children&&0<r.children.length)for(var o=0;o<r.children.length;o++){var a=r.children[o];a.localName&&a.localName.toLowerCase&&a.localName.toLowerCase()===t&&n.push(a)}1<n.length&&(t+=":eq("+n.indexOf(e)+")"),i=t+(i?">"+i:""),e=r}return i}function kiwi_serializeEvent(e){if(e){e={eventName:e.toString(),altKey:e.altKey,bubbles:e.bubbles,button:e.button,buttons:e.buttons,cancelBubble:e.cancelBubble,cancelable:e.cancelable,clientX:e.clientX,clientY:e.clientY,composed:e.composed,ctrlKey:e.ctrlKey,currentTarget:e.currentTarget?e.currentTarget.outerHTML:null,defaultPrevented:e.defaultPrevented,detail:e.detail,eventPhase:e.eventPhase,fromElement:e.fromElement?e.fromElement.outerHTML:null,isTrusted:e.isTrusted,layerX:e.layerX,layerY:e.layerY,metaKey:e.metaKey,movementX:e.movementX,movementY:e.movementY,offsetX:e.offsetX,offsetY:e.offsetY,pageX:e.pageX,pageY:e.pageY,path:kiwi_pathToSelector(e.path&&e.path.length?e.path[0]:null),relatedTarget:e.relatedTarget?e.relatedTarget.outerHTML:null,returnValue:e.returnValue,screenX:e.screenX,screenY:e.screenY,shiftKey:e.shiftKey,sourceCapabilities:e.sourceCapabilities?e.sourceCapabilities.toString():null,target:e.target?e.target.outerHTML:null,timeStamp:e.timeStamp,toElement:e.toElement?e.toElement.outerHTML:null,type:e.type,view:e.view?e.view.toString():null,which:e.which,x:e.x,y:e.y};return JSON.stringify(e,null,2)}return"(null)"}function event_dump(e,i,t){var r=e.key||"(no key)";if(t){var n=isDefined(e.relatedTarget)&&e.relatedTarget?" Trel="+e.relatedTarget.id:"",t="";e.shiftKey&&(t+="shift-"),e.ctrlKey&&(t+="ctrl-"),e.altKey&&(t+="alt-"),e.metaKey&&(t+="meta-"),t+=r,console.log("event_dump "+i+" |"+e.type+"| k="+t+" T="+e.target.id+" Tcur="+e.currentTarget.id+n)}else{if(console.log("================================"),!isArg(e))return console.log("EVENT_DUMP: "+i+" bad evt"),void kiwi_trace();console.log("EVENT_DUMP: "+i+" type="+e.type),console.log((e.shiftKey?"SFT ":"")+(e.ctrlKey?"CTL ":"")+(e.altKey?"ALT ":"")+(e.metaKey?"META ":"")+"key="+r);r=e.currentTarget?e.currentTarget.id:"(null)";console.log("this.id="+this.id+" tgt.name="+e.target.nodeName+" tgt.id="+e.target.id+" ctgt.id="+r);r="";1&e.buttons&&(r+="L"),4&e.buttons&&(r+="M"),2&e.buttons&&(r+="R"),console.log("button="+"LMR"[e.button]+" buttons="+r+" detail="+e.detail),e.type.startsWith("touch")?(console.log("pageX="+e.pageX+" clientX="+e.clientX+" screenX="+e.screenX),console.log("pageY="+e.pageY+" clientY="+e.clientY+" screenY="+e.screenY)):(console.log("pageX="+e.pageX+" clientX="+e.clientX+" screenX="+e.screenX+" offX(EXP)="+e.offsetX+" layerX(DEPR)="+e.layerX),console.log("pageY="+e.pageY+" clientY="+e.clientY+" screenY="+e.screenY+" offY(EXP)="+e.offsetY+" layerY(DEPR)="+e.layerY)),console.log("evt, evt.target, evt.currentTarget, evt.relatedTarget, elementFromPoint:"),console.log(e),console.log(e.target),console.log(e.currentTarget),console.log(e.relatedTarget),isNumber(e.pageX)&&isNumber(e.pageY)?console.log(document.elementFromPoint(e.pageX,e.pageY)):console.log("(no x,y)"),console.log("----")}}function kiwi_rateLimit(i,t){var r=!1;return function(){var e;r||(r=!0,e=arguments,setTimeout(function(){r=!1,i.apply(this,e)},t))}}function kiwi_UTC_minutes(){var e=new Date;return 60*e.getUTCHours()+e.getUTCMinutes()}function kiwi_hh_mm(e){if(isNumber(e))return e;if(isString(e)){var i=e.split(":"),t=+i[0];return 1<i.length&&(e=+i[1]/60,t=t<0?t-e:t+e),t="-0"==i[0]||"-00"==i[0]?-t:t}return null}function kiwi_UTCdoyToDate(e,i,t,r,n){return new Date(Date.UTC(i,0,e,t,r,n))}function kiwi_decodeURIComponent(i,t){var r=null,n=!1;if(dbgUs&&2!=arguments.length)return alert("kiwi_decodeURIComponent: requires exactly two args"),kiwi_trace(),null;for(;null==r;)try{r=decodeURIComponent(t)}catch(e){if(console.log("$kiwi_decodeURIComponent("+i+"): decode fail"),console.log(t),n)return console.log("kiwi_decodeURIComponent("+i+"): DOUBLE DECODE FAIL"),console.log(t),console.log(e),null;for(var o=0;o<t.length-2;o++){var a=t.charAt(o+1),s=t.charAt(o+2);"%"==t.charAt(o)&&isHexDigit(a)&&isHexDigit(s)&&"8"<=a&&(t.charAt(o-1).charCodeAt(0),t=t.substr(0,o)+t.substr(o+3),n=!(o=0))}r=null}return r}kiwi_util.str_recode_lookup=[];var e1=function(e){kiwi_util.str_recode_lookup[ord(e)]=1},e2=function(e){kiwi_util.str_recode_lookup[ord(e)]=2},er=function(e,i,t){for(var r=e;r<=i;r++)kiwi_util.str_recode_lookup[r]=t};function kiwi_str_decode_selective_inplace(e,i){for(var t,r="",n=e.length,o=(e.length,/[0-9a-fA-F]/),a=0;a<n;a++)"%"==e[a]&&a+2<n&&e[a+1].match(o)&&e[a+2].match(o)?(t=parseInt(e[a+1],16)<<4|parseInt(e[a+2],16))<128&&(0==kiwi_util.str_recode_lookup[t]||i&&1==kiwi_util.str_recode_lookup[t])?(r+=chr(t),a+=2):r+="%":r+=e[a];return r}function kiwi_JSON_parse(i,t){var r;try{r=JSON.parse(t)}catch(e){console.log("kiwi_JSON_parse("+i+"): JSON parse fail"),console.log(t),console.log(e),r=null}return r}function kiwi_remove_escape_sequences(e){for(var i=e.split(""),t=[],r=!1,n=!1,o=0;o<i.length;o++){var a=i[o];r?"m"==a&&(r=!1):n?a==kiwi.esc_gt&&(n=!1):""==a&&o+1<i.length&&"["==i[o+1]?(o++,r=!0):a==kiwi.esc_lt?n=!0:"\f"!=a&&t.push(a)}return t.join("")}function kiwi_clean_html(e){return e.replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;")}function kiwi_clean_newline(e){return e.replace(/[\r\n\f\v]/g,"").replace(/\t/g," ")}function kiwi_SSL(){return window.location.protocol+"//"}function kiwi_url_origin(){return window.location.origin}function kiwi_host_port(){return window.location.host}function kiwi_host(){return window.location.hostname}function kiwi_url_param(t,r,e){var n=isArray(t);isUndefined(r)&&(r=!0),isUndefined(e)&&(e=null);var i=window.location&&window.location.search&&window.location.search.substr(1);if(!i)return e;var o=e;return i.split("&").forEach(function(e){var i=e.split("=");n?t.forEach(function(e){e==i[0]&&(o=2<=i.length?i[1]:r)}):t==i[0]&&(o=2<=i.length?i[1]:r)}),o}function kiwi_add_search_param(e,i){e=e.search;return console.log("qs=<"+e+">"),(""!=e&&e.includes("?")?"&":"/?")+i}function kiwi_remove_search_param(e,i){return e=e.replace("?"+i+"&","?").replace("&"+i+"&","&").replace("?"+i,"").replace("&"+i,"")}er(0,127,0),e1("&"),e1("'"),e1("+"),e1(";"),e1("<"),e1(">"),e1("`"),e2('"'),e2("%"),e2("\\"),er(0,31,2),er(127,127,2);var kiwiint_dummy_elem={};function html(i){var t=w3_el(i);try{t.value}catch(e){console.log("html('"+i+"')="+t+" FAILED"),dbgUs&&dbgUsFirst&&(dbgUsFirst=!1)}return t=null==t?kiwiint_dummy_elem:t}function px(e){if(!isArg(e)||""==e)return"0";var i=parseFloat(e);return isNaN(i)?(console.log("px num="+e),kiwi_trace(),"0"):i.toFixed(0)+"px"}function unpx(e){return parseFloat(e)}function css_style(e,i){return(e=w3_el(e))?getComputedStyle(e,null).getPropertyValue(i):null}function css_style_num(e,i){if(!(e=w3_el(e)))return null;i=parseInt(css_style(e,i));return i=isNaN(i)?0:i}function html_LR_border_pad(e){return css_style_num(e,"border-left-width")+css_style_num(e,"border-right-width")+css_style_num(e,"padding-left")+css_style_num(e,"padding-right")}function cancelEvent(e){return(e=e||window.event).stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.cancelBubble=!0,e.cancel=!0,e.returnValue=!1}function ignore(e){return cancelEvent(e)}function kiwi_rgb(e,i,t){return null==e?"":(isArray(e)&&(i=e[1],t=e[2],e=e[0]),"rgb("+Math.floor(e)+","+Math.floor(i)+","+Math.floor(t)+")")}function hsl(e,i,t){return 100<(i=(i=Math.floor(i))<0?0:i)&&(i=100),100<(t=(t=Math.floor(t))<0?0:t)&&(t=100),"hsl("+Math.round(e)+","+i+"%,"+t+"%)"}function createCookie(e,i,t){var r,n="";t&&((r=new Date).setTime(r.getTime()+24*t*60*60*1e3),n="; expires="+r.toGMTString()),document.cookie=e+"="+i+n+"; path=/; SameSite=Lax;"}function readCookie(e,i){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return isDefined(i)?i:null}function writeCookie(e,i){createCookie(e,i,15330)}function initCookie(e,i){var t=readCookie(e);return null==t?(writeCookie(e,i),i):t}function updateCookie(e,i){var t=readCookie(e);return(null==t||t!=i)&&(writeCookie(e,i),!0)}function deleteCookie(e){null!=readCookie(e)&&createCookie(e,0,-1)}function kiwi_storeGet(i,e){var t;if(!isArg(i))return null;try{if(null==localStorage)return null;null==(t=localStorage.getItem(i))&&(null!=(t=readCookie(i))?(console.log("$moving to storage api: "+i+"="+t),kiwi_storeSet(i,t),deleteCookie(i)):t=isDefined(e)?(kiwi_storeSet(i,e),e):null)}catch(e){console.log("$kiwi_storeGet CATCH: "+i),console.log("$kiwi_storeGet CATCH: "+e),t=null}return null==t&&console.log("$ kiwi_storeGet warning: "+i+"=null"),t}function kiwi_storeSet(e,i){if(!isArg(i))return null;try{if(null==localStorage)return null;localStorage.setItem(e,i)}catch(e){return null}return!0}function getVarFromString(e){var t=window,r=e.split(".");for(i=0;i<r.length-1;i++){var n=r[i];if(isUndefined(t=t[n]))throw console.log("getVarFromString: NO SCOPE "+e+" scope_name="+n),"no scope"}return t[r[r.length-1]]}function setVarFromString(e,t){var r=window,n=e.split(".");for(i=0;i<n.length-1;i++)null==r[n[i]]&&(r[n[i]]={}),r=r[n[i]];r[n[n.length-1]]=t}function getType(e){return e&&e.constructor&&e.constructor.name}function kiwi_parseQuery(e){var i=new Object;if(!e)return i;for(var t=e.split(/[;&]/),r=0;r<t.length;r++){var n,o=t[r].split("=");o&&2==o.length&&(n=unescape(o[0]),o=(o=unescape(o[1])).replace(/\+/g," "),i[n]=o)}return i}function getTextWidth(e,i){var t=(getTextWidth.canvas||(getTextWidth.canvas=document.createElement("canvas"))).getContext("2d");return t.font=i,t.measureText(e).width}function kiwi_GETrequest(e,i,t){var r=w3_opt(t,"debug",0),n=document.createElement("iframe"),t=e+"_"+(new Date).toUTCString().substr(17,8);document.body.appendChild(n),n.style.display="none",n.contentWindow.name=t,w3_add(n,"id-kiwi_GETrequest");e=document.createElement("form");return e.target=t,e.action=i,e.method="GET",w3_add(e,"id-kiwi_GETrequest"),r&&console.log("kiwi_GETrequest: "+t),{iframe:n,form:e,debug:r}}function kiwi_GETrequest_submit(e,i){var t=w3_opt(i,"no_submit",0),i=w3_opt(i,"gc",0);t?console.log("kiwi_GETrequest_submit: NO SUBMIT"):(document.body.appendChild(e.form),e.form.submit(),e.debug&&console.log("kiwi_GETrequest_submit: SUBMITTED")),i&&setTimeout(function(){document.body.removeChild(e.form),document.body.removeChild(e.iframe)},6e4)}function kiwi_GETrequest_param(e,i,t){var r=document.createElement("input");r.type="hidden",r.name=i,r.value=t,e.form.appendChild(r),e.debug&&console.log("kiwi_GETrequest_param: "+i+"="+t)}var ajax_state={DONE:4};function kiwi_ajax(e,i,t,r,n){kiwi_ajax_prim("GET",null,e,i,t,r,void 0,void 0,n)}function kiwi_ajax_progress(e,i,t,r,n,o,a){kiwi_ajax_prim("GET",null,e,i,t,r,n,o,a)}function kiwi_ajax_send(e,i,t,r,n,o){kiwi_ajax_prim("PUT",e,i,t,r,n,void 0,void 0,o)}var ajax_id=0,ajax_requests={};function kiwi_ajax_prim(e,i,n,o,a,t,r,s,l){var c;ajax_id++;function u(e){l&&console.log(e)}try{c=new XMLHttpRequest}catch(e){try{c=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{c=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return!1}}}return c.kiwi_id=ajax_id,ajax_requests[ajax_id]={},ajax_requests[ajax_id].didTimeout=!1,ajax_requests[ajax_id].timer=-1,(t=t||0)&&(ajax_requests[ajax_id].timer=setTimeout(function(){var e=c.kiwi_id;ajax_requests[e].didTimeout=!0,ajax_requests[e].timer=-1,console.log("$AJAX TIMEOUT url="+n);w3_call(o,{AJAX_error:"timeout"},a),c.abort(),delete ajax_requests[e]},Math.abs(t))),r&&(u("AJAX with progress_cb="+r),c.onprogress=function(){var e=c.responseText.toString()||"";u("XHR.onprogress="+e),w3_call(r,e,s)}),c.onerror=function(e){u("XHR.onerror="+e),l&&console.log(e)},c.onabort=function(e){u("XHR.onabort="+e),l&&console.log(e)},c.onload=function(e){u("XHR.onload="+e),l&&console.log(e)},c.onloadstart=function(e){u("XHR.onloadstart="+e),l&&console.log(e)},c.onreadystatechange=function(){if(u("XHR.onreadystatechange readyState="+c.readyState),c.readyState!=ajax_state.DONE)return!1;var i,e=c.kiwi_id,t=ajax_requests[e].timer;if(u("AJAX ORSC ENTER recovered id="+e+" timer="+t+" cb="+o),-1!=t&&(u("AJAX ORSC CLEAR_TIMER recovered id="+e+" timer="+t),kiwi_clearTimeout(t),ajax_requests[e].timer=-1),ajax_requests[e].didTimeout)u("AJAX ORSC TIMED_OUT recovered id="+e);else{if(u("XHR.status="+c.status),u("XHR.statusText="+c.statusText),u("XHR.responseType="+c.responseType),u("XHR.response="+c.response),u("XHR.responseText="+c.responseText),u("XHR.responseURL="+c.responseURL),l&&console.log(c),200!=c.status)console.log("$AJAX BAD STATUS="+c.status+" url="+n),i={AJAX_error:"status",status:c.status};else{var r=c.responseText.toString();if((r=null==r?"":r).startsWith("<?xml"))i={XML:!0,text:r};else{t=r.charAt(0);if("{"==t||"["==t||"0"<=t&&t<="9")try{r=kiwi_remove_cjson_comments(r),i=JSON.parse(r),u("AJAX JSON response:"),u(r),u(i)}catch(e){u("AJAX response JSON.parse failed: <"+r+">"),u(e),i={AJAX_error:"JSON parse",JSON_ex:e.toString(),response:r}}else u("AJAX: response didn't begin with JSON '{', '[' or digit? "+r),i={AJAX_error:"JSON prefix",response:r}}}u("AJAX ORSC CALLBACK recovered id="+e+" callback="+typeof o),w3_call(o,i,a)}u("AJAX ORSC ABORT/DELETE"),c.abort(),delete ajax_requests[e]},0<=t&&(c.open(e,n,!0),u("AJAX SEND id="+ajax_id+" url="+n),c.send(i)),!0}function kiwi_remove_cjson_comments(e){for(var i,t;-1!=(i=e.indexOf("\n//"));)t=e.indexOf("\n",i+3),e=e.slice(0,i)+e.slice(t);return e}function kiwi_scrollbar_width(){return kiwi_isMacOS()?10:15}function kiwi_strip_tags(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,i){return-1<t.indexOf("<"+i.toLowerCase()+">")?e:""})}function kiwi_pie(e,i,t,r){var n=2*i;return'<svg width="'+n+'" height="'+n+'" viewbox="0 0 '+n+" "+n+'"><circle cx="'+i+'" cy="'+i+'" r="'+i+'" fill="'+t+'" /><path class="'+e+'" style="fill:'+r+'" transform="translate('+i+", "+i+')" /></svg>'}function kiwi_draw_pie(e,i,t){var r=360*t,n=r*Math.PI/180,o=Math.sin(n)*i,t=Math.cos(n)*-i,n=180<=r?1:0;360==r&&(n=1,o=-.1,t=-i);var a="M 0 0 v "+-i+" A "+i+" "+i+" 1 "+n+" 1 "+o+" "+t+" z";w3_iterate_classname(e,function(e){e.setAttribute("d",a)})}function enc(e){return e.replace(/./gi,function(e){return String.fromCharCode(3^e.charCodeAt(0))})}var sendmail=function(e,i){i="mailto:"+enc(decodeURIComponent(e))+(isDefined(i)?"?subject="+i:"");window.location.href=i};function line_stroke(e,i,t,r,n,o,a,s){var l=Math.floor(t/2),a=i?t:a-n+1,t=i?s-o+1:t,n=n-(i?l:0),l=o-(i?0:l);e.fillStyle=r,e.fillRect(n,l,a,t)}var wsockets=[];function msg_send(i){for(var e=0;e<wsockets.length;e++){var t=wsockets[e].ws;if(t.up)try{return t.send(i),0}catch(e){return console.log("CATCH msg_send('"+i+"') ex="+e),kiwi_trace(),-1}}return-1}function open_websocket(e,i,t,r,n,o,a){if(!("WebSocket"in window&&"CLOSING"in WebSocket))return console.log("WEBSOCKET TEST"),kiwi_serious_error("Your browser does not support WebSocket, which is required for OpenWebRX to run. <br> Please use an HTML5 compatible browser."),null;var s=kiwi_url_origin().split("://")[1],l="ws://";"https:"===window.location.protocol&&(l="wss://");var c=window.location.href.includes("?no_wf")||window.location.href.includes("&no_wf"),s=l+s+"/"+(c?"no_wf/":"kiwi/")+timestamp+"/"+e;c&&(wf.no_wf=!0);var u=new WebSocket(s);return wsockets.push({ws:u,name:e}),u.up=!1,u.stream=e,u.open_cb=i,u.open_cb_param=t,u.msg_cb=r,u.recv_cb=n,u.error_cb=o,u.close_cb=a,u.onopen=function(){if(u.up=!0,u.open_cb)try{u.open_cb(u.open_cb_param)}catch(e){console.log(e)}},u.onmessage=function(e){on_ws_recv(e,u)},u.onclose=function(e){if(u.up=!1,console.log("WS-CLOSE: "+u.stream),u.close_cb)try{u.close_cb(u)}catch(e){console.log(e)}},u.binaryType="arraybuffer",u.onerror=function(e){if(u.error_cb)try{u.error_cb(e,u)}catch(e){console.log(e)}},u}var kiwi_flush_recv_input=!0;function recv_websocket(e,i){"SND"!=e.stream&&"W/F"!=e.stream&&null==(e.recv_cb=i)&&(kiwi_flush_recv_input=!0)}function on_ws_recv(e,i){var t=e.data;if(t instanceof ArrayBuffer){if(!seriousError){var r=arrayBufferToStringLen(t,3);if("CLI"!=r){var n=!1;if("MSG"==r){e=arrayBufferToString(t);params=e.substring(4).split(" ");for(var o=0;o<params.length;o++){var a=params[o].split("=");"EXT"==i.stream&&"EXT-STOP-FLUSH-INPUT"==a[0]&&(kiwi_flush_recv_input=!1),0==(n=0==(n=kiwi_msg(a,i))&&i.msg_cb?i.msg_cb(a,i):n)&&console.log(">>> "+i.stream+": message not claimed: "+params[o])}}else!i.recv_cb||"EXT"==i.stream&&0!=kiwi_flush_recv_input||(i.recv_cb(t,i,r),isDefined(kiwi_gc_recv)&&kiwi_gc_recv&&(t=null))}}}else console.log("on_ws_recv: not an ArrayBuffer?")}window.onbeforeunload=function(){for(var e=0;e<wsockets.length;e++){var i=wsockets[e].ws;i&&(i.onclose=function(){},i.close())}};



