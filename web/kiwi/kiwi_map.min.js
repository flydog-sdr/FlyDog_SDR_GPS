

/* web/kiwi/kiwi_map.min.js (web/kiwi/kiwi_map.js = Sun Sep 10 17:48:58 2023) */
var kmap={ADD_TO_MAP:true,NO_ADD_TO_MAP:false,DIR_LEFT:true,DIR_RIGHT:false,VISIBLE:true,NOT_VISIBLE:false,_last_last:0};function kiwi_map_init(ext_name,init_latlon,init_zoom,mapZoom_nom,move_cb,zoom_cb){var map_tiles;var maxZoom=19;map_tiles=function(){maxZoom=18;return L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{tileSize:256,zoomOffset:0,attribution:'<a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>',crossOrigin:true});}
var tiles=map_tiles('hybrid');var map=L.map('id-'+ext_name+'-map',{maxZoom:maxZoom,minZoom:1,doubleClickZoom:false,zoomControl:false}).setView(init_latlon,init_zoom);map.on('baselayerchange',function(e){var tmap=e.target;var center=tmap.getCenter();kiwi_pan_zoom(tmap,[center.lat+0.1,center.lng],-1);kiwi_pan_zoom(tmap,[center.lat,center.lng],-1);});var kmap={ext_name:ext_name,map:map};map.on('click',function(e,kmap){w3_call(ext_name+'_map_click_cb',kmap,e);});map.on('move',function(e,kmap){w3_call(ext_name+'_map_move_cb',kmap,e);});map.on('zoom',function(e,kmap){w3_call(ext_name+'_map_zoom_cb',kmap,e);});map.on('moveend',function(e,kmap){w3_call(ext_name+'_map_move_end_cb',kmap,e);});map.on('zoomend',function(e,kmap){w3_call(ext_name+'_map_zoom_end_cb',kmap,e);});L.control.zoom_Kiwi({position:'topright',zoomNomText:'2',zoomNomLatLon:init_latlon}).addTo(map);tiles.addTo(map);var scale=L.control.scale()
scale.addTo(map);scale.setPosition('bottomleft');var day_night=new Terminator();day_night.setStyle({fillOpacity:0.35});day_night.addTo(map);kmap.day_night_interval=setInterval(function(){var t2=new Terminator();day_night.setLatLngs(t2.getLatLngs());day_night.redraw();},60000);day_night._path.style.cursor='grab';var graticule=L.latlngGraticule();graticule.addTo(map);kmap.map_layers=[graticule];kmap.graticule=graticule;kmap.day_night=day_night;kmap.init_latlon=init_latlon;kmap.init_zoom=init_zoom;kmap.mapZoom_nom=mapZoom_nom;return kmap;}
function kiwi_map_blur(kmap){kiwi_clearInterval(kmap.day_night_interval);}
function kiwi_map_add_marker_icon(kmap,addToMap,url,latlon,anchor,opacity,func){var kiwi_icon=L.icon({iconUrl:url,iconAnchor:anchor});var kiwi_mkr=L.marker(latlon,{'icon':kiwi_icon,'opacity':opacity});if(addToMap){kiwi_mkr.addTo(kmap.map);if(func)func(kiwi_mkr._icon);}}
function kiwi_map_add_marker_div(kmap,addToMap,latlon,className,iconAnchor,tooltipAnchor,opacity){var icon=L.divIcon({className:className,html:'',iconAnchor:iconAnchor,tooltipAnchor:tooltipAnchor});var marker=L.marker(latlon,{'icon':icon,'opacity':opacity});if(addToMap)marker.addTo(kmap.map);return marker;}
function kiwi_style_marker(kmap,addToMap,marker,name,className,left,func){marker.bindTooltip(name,{className:className,permanent:true,direction:left?'left':'right'});if(func)marker.on('add',function(ev){func(ev);});if(addToMap){marker.addTo(kmap.map);kmap.map_layers.push(marker);}}
function kiwi_map_day_night_visible(kmap,vis){var day_night=kmap.day_night;if(vis){day_night.addTo(kmap.map);kmap.map_layers.push(day_night);day_night._path.style.cursor='grab';}else{day_night.remove();kmap.map_layers=kmap.map_layers.filter(function(ae){ae!=day_night});}}
function kiwi_map_graticule_visible(kmap,vis){var graticule=kmap.graticule;if(vis){graticule.addTo(kmap.map);kmap.map_layers.push(graticule);}else{graticule.remove();kmap.map_layers=kmap.map_layers.filter(function(ae){ae!=graticule});}}
function kiwi_map_markers_visible(id,vis){w3_iterate_children('leaflet-marker-pane',function(el,i){if(el.className.includes(id)){w3_hide2(el,!vis);}});w3_iterate_children('leaflet-tooltip-pane',function(el,i){if(el.className.includes(id)){w3_hide2(el,!vis);}});}
function kiwi_pan_zoom(map,latlon,zoom){if(latlon==null)latlon=map.getCenter();if(zoom==-1)zoom=map.getZoom();map.setView(latlon,zoom,{duration:0,animate:false});}



